<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.98" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Linux 磁盘与文件系统管理","image":["https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-硬盘接口.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-chs寻址方式.png","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-partition-table.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-partition-table-extend.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-boot-loader.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-guid-partition-table.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-map.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-01.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-02.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-03.png?x-oss-process=image/resize,w_800","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-inode结构示意图.png","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-04.png?x-oss-process=image/resize,w_800","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-小文件占用block.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-大文件占用block.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-目录内存分布.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-目录内存示意图如.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-符号链接文件读取示意图.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-hardlink举例.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-hardlink读取示意图.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-硬链接.png","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-09.png?x-oss-process=image/resize,w_800","https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-10.png?x-oss-process=image/resize,w_800","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-VFS中间层.png","https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-dumpe2fs.png"],"dateModified":"2025-11-19T08:16:03.000Z","author":[{"@type":"Person","name":"Henry Dai","url":"https://mister-hope.com"}]}</script><meta property="og:url" content="https://mister-hope.github.io/linux/Linux%E7%A3%81%E7%9B%98%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86.html"><meta property="og:site_name" content="博客演示"><meta property="og:title" content="Linux 磁盘与文件系统管理"><meta property="og:description" content="Linux 磁盘与文件系统管理 硬盘接口 常见的硬盘接口有：IDE 、SATA、SAS、USB、SCSI，其中 SATA 是目前的主流接口，IDE 则几乎不再使用。 设备文件 计算机的各种硬件设备在 Linux 中都有对应的设备文件，甚至不同的接口也对应着不同的设备文件，从而使用不同的驱动程序来操作硬件设备。对于硬盘，实体设备的文件名一般是 /dev/..."><meta property="og:type" content="article"><meta property="og:image" content="https://mister-hope.github.io/assets/images/Linux%20磁盘与文件系统管理-硬盘接口.png"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-11-19T08:16:03.000Z"><meta property="article:modified_time" content="2025-11-19T08:16:03.000Z"><title>Linux 磁盘与文件系统管理 | 博客演示</title><meta name="description" content="Linux 磁盘与文件系统管理 硬盘接口 常见的硬盘接口有：IDE 、SATA、SAS、USB、SCSI，其中 SATA 是目前的主流接口，IDE 则几乎不再使用。 设备文件 计算机的各种硬件设备在 Linux 中都有对应的设备文件，甚至不同的接口也对应着不同的设备文件，从而使用不同的驱动程序来操作硬件设备。对于硬盘，实体设备的文件名一般是 /dev/...">
    <link rel="stylesheet" href="/assets/css/styles.f710025f.css">
    <link rel="preload" href="/assets/js/runtime~app.b96c3b68.js" as="script"><link rel="preload" href="/assets/css/styles.f710025f.css" as="style"><link rel="preload" href="/assets/js/1960.b4000e88.js" as="script"><link rel="preload" href="/assets/js/app.c88efbf5.js" as="script">
    <link rel="prefetch" href="/assets/js/linux_Linux磁盘与文件系统管理.html.88f891a9.js" as="script"><link rel="prefetch" href="/assets/js/8300.ec4854ba.js" as="script"><link rel="prefetch" href="/assets/js/demo_markdown.html.299b39e0.js" as="script"><link rel="prefetch" href="/assets/js/demo_page.html.7d3d6dd4.js" as="script"><link rel="prefetch" href="/assets/js/demo_layout.html.20d5aafd.js" as="script"><link rel="prefetch" href="/assets/js/index.html.275af7e7.js" as="script"><link rel="prefetch" href="/assets/js/java_springboot_基础入门.html.ece8416f.js" as="script"><link rel="prefetch" href="/assets/js/posts_tomato.html.50129101.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_2.html.54a12df9.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_2.html.ec0af5f3.js" as="script"><link rel="prefetch" href="/assets/js/demo_disable.html.922ba04d.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_1.html.c445f4ed.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_3.html.6779ab5c.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_4.html.26f16bac.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_4.html.9f2f918a.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_3.html.8b453e7b.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_1.html.decdcec4.js" as="script"><link rel="prefetch" href="/assets/js/posts_cherry.html.4418e017.js" as="script"><link rel="prefetch" href="/assets/js/posts_dragonfruit.html.098913d5.js" as="script"><link rel="prefetch" href="/assets/js/posts_strawberry.html.ffd70601.js" as="script"><link rel="prefetch" href="/assets/js/intro.html.fb45196b.js" as="script"><link rel="prefetch" href="/assets/js/java_spring_index.html.16899a01.js" as="script"><link rel="prefetch" href="/assets/js/algorithm_index.html.06f28510.js" as="script"><link rel="prefetch" href="/assets/js/front-end_index.html.0758ef55.js" as="script"><link rel="prefetch" href="/assets/js/interview_index.html.d8c9a80a.js" as="script"><link rel="prefetch" href="/assets/js/project_index.html.62bd4c8a.js" as="script"><link rel="prefetch" href="/assets/js/linux_index.html.7b86718c.js" as="script"><link rel="prefetch" href="/assets/js/java_index.html.e63393e9.js" as="script"><link rel="prefetch" href="/assets/js/demo_index.html.336a063e.js" as="script"><link rel="prefetch" href="/assets/js/demo_encrypt copy.html.ead1bdac.js" as="script"><link rel="prefetch" href="/assets/js/java_springboot_index.html.d191e3b0.js" as="script"><link rel="prefetch" href="/assets/js/demo_encrypt.html.faeda456.js" as="script"><link rel="prefetch" href="/assets/js/category_使用指南_index.html.3c088985.js" as="script"><link rel="prefetch" href="/assets/js/tag_使用指南_index.html.af27450a.js" as="script"><link rel="prefetch" href="/assets/js/tag_页面配置_index.html.44aa17ac.js" as="script"><link rel="prefetch" href="/assets/js/category_火龙果_index.html.809b5cfd.js" as="script"><link rel="prefetch" href="/assets/js/tag_弯曲的_index.html.688f0197.js" as="script"><link rel="prefetch" href="/assets/js/category_springboot_index.html.2a3eab94.js" as="script"><link rel="prefetch" href="/assets/js/category_指南_index.html.2309d68c.js" as="script"><link rel="prefetch" href="/assets/js/category_樱桃_index.html.75492f2b.js" as="script"><link rel="prefetch" href="/assets/js/category_水果_index.html.d20b2ca7.js" as="script"><link rel="prefetch" href="/assets/js/category_算法_index.html.afea0505.js" as="script"><link rel="prefetch" href="/assets/js/category_苹果_index.html.936833ba.js" as="script"><link rel="prefetch" href="/assets/js/category_草莓_index.html.db6df54e.js" as="script"><link rel="prefetch" href="/assets/js/category_蔬菜_index.html.d49bd46f.js" as="script"><link rel="prefetch" href="/assets/js/category_面试_index.html.d3f37042.js" as="script"><link rel="prefetch" href="/assets/js/category_项目_index.html.5fed7e53.js" as="script"><link rel="prefetch" href="/assets/js/category_香蕉_index.html.bd8ffdf5.js" as="script"><link rel="prefetch" href="/assets/js/category_前端_index.html.5db5d06c.js" as="script"><link rel="prefetch" href="/assets/js/tag_加密_index.html.99dd51e7.js" as="script"><link rel="prefetch" href="/assets/js/tag_禁用_index.html.444a5e86.js" as="script"><link rel="prefetch" href="/assets/js/tag_布局_index.html.95de2f62.js" as="script"><link rel="prefetch" href="/assets/js/tag_markdown_index.html.c301a1a9.js" as="script"><link rel="prefetch" href="/assets/js/category_spring_index.html.9fc3a0c4.js" as="script"><link rel="prefetch" href="/assets/js/404.html.a7d9498a.js" as="script"><link rel="prefetch" href="/assets/js/category_linux_index.html.57a5230d.js" as="script"><link rel="prefetch" href="/assets/js/category_java_index.html.2df7d8c8.js" as="script"><link rel="prefetch" href="/assets/js/tag_大_index.html.805f2bc7.js" as="script"><link rel="prefetch" href="/assets/js/tag_小_index.html.5e047b8d.js" as="script"><link rel="prefetch" href="/assets/js/tag_红_index.html.908db8f5.js" as="script"><link rel="prefetch" href="/assets/js/tag_长_index.html.855783cf.js" as="script"><link rel="prefetch" href="/assets/js/tag_圆_index.html.3f114833.js" as="script"><link rel="prefetch" href="/assets/js/tag_黄_index.html.0e36373d.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.e8a27aac.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.471b657c.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.1d7f7a06.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.c257bd01.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.bf7baf3d.js" as="script"><link rel="prefetch" href="/assets/js/posts_banana_index.html.00d0de9a.js" as="script"><link rel="prefetch" href="/assets/js/posts_apple_index.html.a9172659.js" as="script"><link rel="prefetch" href="/assets/js/posts_index.html.b9df0073.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/" aria-label="带我回家"><img class="vp-nav-logo" src="https://theme-hope-assets.vuejs.press/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">博客演示</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/" aria-label="主页"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:house" sizing="height" height="1em"></iconify-icon><!--]-->主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/java/" aria-label="Java"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->Java<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/interview/" aria-label="面试"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->面试<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/algorithm/" aria-label="算法"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->算法<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/front-end/" aria-label="前端"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->前端<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/project/" aria-label="项目"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->项目<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/linux/" aria-label="Linux"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->Linux<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/demo/" aria-label="主要功能与配置演示"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="height" height="1em"></iconify-icon><!--]-->主要功能与配置演示<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="博文"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="height" height="1em"></iconify-icon>博文<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">苹果</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/apple/1.html" aria-label="苹果1"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->苹果1<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/apple/2.html" aria-label="苹果2"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->苹果2<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/apple/3.html" aria-label="苹果 3"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->苹果 3<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/apple/4.html" aria-label="苹果 4"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->苹果 4<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">香蕉</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/banana/1.html" aria-label="香蕉 1"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->香蕉 1<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/banana/2.html" aria-label="香蕉 2"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->香蕉 2<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/banana/3.html" aria-label="香蕉 3"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->香蕉 3<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/posts/banana/4.html" aria-label="香蕉 4"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->香蕉 4<!----></a></li></ul></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/cherry.html" aria-label="樱桃"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->樱桃<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/dragonfruit.html" aria-label="火龙果"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->火龙果<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/tomato.html" aria-label="番茄"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->番茄<!----></a></li><li class="vp-dropdown-item"><a class="route-link auto-link" href="/posts/strawberry.html" aria-label="草莓"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->草莓<!----></a></li></ul></button></div></div><div class="vp-nav-item hide-in-mobile"><a class="auto-link external-link" href="https://theme-hope.vuejs.press/zh/" aria-label="V2 文档" rel="noopener noreferrer" target="_blank"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:book" sizing="height" height="1em"></iconify-icon><!--]-->V2 文档<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Dhongli/vuepress-blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/" aria-label="主页"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:house" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->主页<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/java/" aria-label="Java"><!---->Java<!----></a><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/interview/" aria-label="面试"><!---->面试<!----></a><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/algorithm/" aria-label="算法"><!---->算法<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/front-end/" aria-label="前端"><!---->前端<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/project/" aria-label="项目"><!---->项目<!----></a><!----></p><ul class="vp-sidebar-links"></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable active"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link route-link-active auto-link vp-sidebar-title no-external-link-icon" href="/linux/" aria-label="Linux"><!---->Linux<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/linux/Linux%E7%A3%81%E7%9B%98%E4%B8%8E%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86.html" aria-label="Linux 磁盘与文件系统管理"><!---->Linux 磁盘与文件系统管理<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header clickable"><iconify-icon class="vp-icon" icon="fa6-solid:laptop-code" sizing="both" width="1em" height="1em"></iconify-icon><a class="route-link auto-link vp-sidebar-title no-external-link-icon" href="/demo/" aria-label="如何使用"><!---->如何使用<!----></a><!----></p><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/demo/markdown.html" aria-label="Markdown"><!--[--><iconify-icon class="vp-icon" icon="fa6-brands:markdown" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->Markdown<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/demo/layout.html" aria-label="布局"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lock" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->布局<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/demo/page.html" aria-label="页面配置"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:file" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->页面配置<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/demo/disable.html" aria-label="布局与功能禁用"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:gears" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->布局与功能禁用<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/demo/encrypt.html" aria-label="密码加密的文章"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lock" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->密码加密的文章<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/demo/encrypt%20copy.html" aria-label="密码加密的文章2"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:lock" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->密码加密的文章2<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header"><iconify-icon class="vp-icon" icon="fa6-solid:book" sizing="both" width="1em" height="1em"></iconify-icon><span class="vp-sidebar-title">文章</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Apple</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Banana</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/cherry.html" aria-label="樱桃"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->樱桃<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/dragonfruit.html" aria-label="火龙果"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->火龙果<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/tomato.html" aria-label="番茄"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->番茄<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/posts/strawberry.html" aria-label="草莓"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:pen-to-square" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->草莓<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/intro.html" aria-label="介绍页"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:circle-info" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->介绍页<!----></a></li><li><a class="auto-link external-link vp-sidebar-link" href="https://ecosystem.vuejs.press/zh/plugins/markdown/revealjs/demo.html" aria-label="幻灯片" rel="noopener noreferrer" target="_blank"><!--[--><iconify-icon class="vp-icon" icon="fa6-solid:person-chalkboard" sizing="both" width="1em" height="1em"></iconify-icon><!--]-->幻灯片<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->Linux 磁盘与文件系统管理</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mister-hope.com" target="_blank" rel="noopener noreferrer">Henry Dai</a></span><span property="author" content="Henry Dai"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/11/19</span><meta property="datePublished" content="2025-11-19T08:16:03.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 107 分钟</span><meta property="timeRequired" content="PT107M"></span><!----><!----></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h1 id="linux-磁盘与文件系统管理" tabindex="-1"><a class="header-anchor" href="#linux-磁盘与文件系统管理"><span>Linux 磁盘与文件系统管理</span></a></h1><h1 id="硬盘接口" tabindex="-1"><a class="header-anchor" href="#硬盘接口"><span>硬盘接口</span></a></h1><p>常见的硬盘接口有：<strong>IDE</strong> 、<strong>SATA</strong>、<strong>SAS</strong>、<strong>USB</strong>、<strong>SCSI</strong>，其中 SATA 是目前的主流接口，IDE 则几乎不再使用。</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-硬盘接口.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h1 id="设备文件" tabindex="-1"><a class="header-anchor" href="#设备文件"><span>设备文件</span></a></h1><p>计算机的各种硬件设备在 Linux 中都有对应的设备文件，甚至不同的接口也对应着不同的设备文件，从而使用不同的驱动程序来操作硬件设备。对于硬盘，实体设备的文件名一般是 <code>/dev/sd[a-]</code>；虚拟设备（虚拟机中的硬盘）的文件名一般是 <code>/dev/vd[a-]</code>。</p><p>有时，系统中会有 <code>/dev/sda</code>、<code>/dev/sdb</code>...等设备文件，它们之间又是什么关系呢？实际上，<code>/dev/sd[a-]</code> 是 SATA/USB/SAS 等硬盘接口对应的设备文件，这类接口都使用 SCSI 模块作为驱动程序。<code>a</code>、<code>b</code>、<code>c</code>...则是按系统检测到的顺序来排列的，与实际插槽顺序无关。</p><p>我们知道硬盘是可以被分区成多个分区（partition），如在 Windows 中可以将一块硬盘分区成 <code>C:</code>、<code>D:</code>、<code>E:</code> 盘。那么，不同的分区是否也有对应的设备文件呢？</p><h1 id="硬盘结构" tabindex="-1"><a class="header-anchor" href="#硬盘结构"><span>硬盘结构</span></a></h1><p>提到分区，我们需要先了解一下硬盘的结构。不同寻址方式的硬盘，其结构也不同。硬盘的寻址方式主要有两种：</p><ul><li><strong>CHS 寻址方式</strong>：由柱面数（Cylinders）、磁头数（Headers）、扇区数（Sectors）组成 3D 参数，简称 CHS 寻址方式，硬盘容量相对较小。如传统的机械硬盘（Hard Disk Drive，HDD）。</li><li><strong>LBA 寻址方式</strong>：线性寻址，以逻辑区块为单位进行寻址，全称为 Logic Block Address（即扇区的逻辑块地址），硬盘容量相对较大。如固态硬盘（Solid State Disk，SSD）</li></ul><h2 id="chs-寻址方式" tabindex="-1"><a class="header-anchor" href="#chs-寻址方式"><span>CHS 寻址方式</span></a></h2><p>如下图所为 CHS 寻址方式的硬盘结构，硬盘主要由盘片、机械手臂、磁头、主轴马达组成。盘片是数据存储的媒介，圆形，通过机械手臂读写数据，盘片需要转动才能够让机械手臂读写。因此，可以将盘片同心圆分割成一个个的小区块，这些区块组成一个圆形，可以让机械手臂的磁头进行读写。这个小区块就是硬盘的最小物理存储单位，即 <strong>扇区（sector）</strong>。位于同一个同心圆上的扇区组成的圆环，即 <strong>磁道（track）</strong>。硬盘中可能包含多个盘片，在所有盘片上的同一个磁道组成了所谓的 <strong>柱面（cylinder）</strong>，柱面是文件系统的最小单位，也是分区的最小单位。<br><img src="/assets/images/Linux 磁盘与文件系统管理-chs寻址方式.png" alt="" loading="lazy"></p><h2 id="lba-寻址方式" tabindex="-1"><a class="header-anchor" href="#lba-寻址方式"><span>LBA 寻址方式</span></a></h2><p>LBA 寻址方式的硬盘使用集成电路代替物理旋转磁盘，主要由主控与闪存芯片组成。数据的读写速度远远高于 CHS 寻址方式的硬盘。</p><h1 id="硬盘分区" tabindex="-1"><a class="header-anchor" href="#硬盘分区"><span>硬盘分区</span></a></h1><p>了解了硬盘结构，再来看硬盘分区。</p><p>关于硬盘分区，首先思考一个问题：为什么要分区？其实主要有两个原因：</p><ol><li>数据的安全性。由于每个分区的数据是独立的，使得数据更加安全。</li><li>访存的高效性。对于 CHS 寻址方式的硬盘，由于分区将数据集中在某个柱面的区段，如第一个分区位于柱面号 1~100。当需要对该分区进行访存时，硬盘只会在 1~100 柱面范围内进行操作，从而提升了数据的访存性能。</li></ol><p>既然硬盘能被分区，那么其分区信息是如何保存的呢？答案就是分区表。但是对于不同寻址方式的硬盘，其分区表的格式也不同，主要有两种：</p><ul><li><strong>MBR 分区表</strong>：多用于 CHS 寻址方式的硬盘</li><li><strong>GUID 分区表</strong>：多用于 LBA 寻址方式的硬盘</li></ul><p>分区表有存储在哪里呢？和绝大多数文件将自身的基本描述信息放在文件的开头类似，分区表作为硬盘的基本信息，同样保存在硬盘最前面的存储区域。</p><p>下面分别介绍 MBR 分区表和 GUID 分区表。</p><h2 id="mbr-分区表" tabindex="-1"><a class="header-anchor" href="#mbr-分区表"><span><strong>MBR 分区表</strong></span></a></h2><p>MBR 分区表保存在硬盘的 <strong>第一个扇区</strong>，由于第一个扇区主要记录了两个重要信息，也称为 <strong>主引导记录区（Master Boot Record，MBR）</strong>。这两个信息分别是：</p><ul><li><strong>MBR 分区表</strong>：记录整个硬盘的分区信息，容量为 64 Bytes。</li><li><strong>引导程序（Boot Loader）</strong>：容量为 446 Bytes。</li></ul><h3 id="mbr-分区表-1" tabindex="-1"><a class="header-anchor" href="#mbr-分区表-1"><span>MBR 分区表</span></a></h3><p>分区表占据了 MBR 64 Bytes 的空间，最多只能记录 4 组分区信息，每组分区信息记录了该分区的 <strong>起始与结束的柱面号</strong>，这 4 组分区信息称为 <strong>主要分区（primary partition）</strong> 或 <strong>延伸分区（extended partition）</strong>。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-partition-table.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>假设上述硬盘的设备文件名为 <code>/dev/sda</code>，则这四个分区在 Linux 中的设备文件名如下所示，重点在于文件名后面会再接一个数字，这个数字与分区在硬盘中的位置有关。</p><ul><li>P1：<code>/dev/sda1</code></li><li>P2：<code>/dev/sda2</code></li><li>P3：<code>/dev/sda3</code></li><li>P4：<code>/dev/sda4</code></li></ul><p>由于分区表只有 64 Bytes，最多只能记录 4 组分区信息，那么是否意味着一个硬盘最多只能分割成 4 个分区呢？当然不是！<strong>虽然第一个扇区的分区表只能记录 4 组分区信息，但是利用其中的延伸分区信息进一步索引到一个新的分区表，从而记录更多分区信息</strong>。如下图所示：</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-partition-table-extend.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>上图所示，硬盘第一个扇区中的四个分区记录仅仅使用了两个，P1 为 <strong>主要分区</strong>，P2 为 <strong>延伸分区</strong>。延伸分区的目的是使用额外的扇区来记录分区信息。通过延伸分区所指向的那个区块继续记录分区信息。上图延伸分区索引的分区表继续分出了 5 个分区，这 5 个有延伸分区分出来的分区，称为 <strong>逻辑分区（logical partition）</strong>。</p><p>同理，上图中的分区在 Linux 中的设备文件名如下所示。其中的 <code>/dev/sda3</code> 和 <code>/dev/sda4</code> 则保留给主要分区和延伸分区了，所以逻辑分区的设备文件名从 5 开始。</p><ul><li>P1：<code>/dev/sda1</code></li><li>P2：<code>/dev/sda2</code></li><li>L1：<code>/dev/sda5</code></li><li>L2：<code>/dev/sda6</code></li><li>L3：<code>/dev/sda7</code></li><li>L4：<code>/dev/sda8</code></li><li>L5：<code>/dev/sda9</code></li></ul><blockquote><p>MBR 主要分区、延伸分区、逻辑分区的特性 - 主要分区与延伸分区最多可以有 4 个（硬盘的限制） - 延伸分区最多只有一个（操作系统的限制） - 逻辑分区是由延伸分区持续分割出来的分区 - 主要分区和逻辑分区可以被格式化；延伸分区不能被格式化 - 逻辑分区的数量上限由操作系统决定</p></blockquote><h3 id="引导程序-boot-loader" tabindex="-1"><a class="header-anchor" href="#引导程序-boot-loader"><span>引导程序（Boot Loader）</span></a></h3><p>Boot loader 是操作系统安装在 MBR 中的一套软件，但 MRB 仅仅提供 446 Bytes 的空间给 boot loader，所以 boot loader 是极其精简的。其主要完成以下任务：</p><ol><li>提供菜单：用户可以选择不同的开机项目</li><li>载入核心文件：直接指向可开机的程序区段来启动操作系统</li><li>转交其他 loader：将开机管理功能转交给其他 loader 负责，主要用于多系统引导。</li></ol><p>对于第 3 项，表示计算机系统中可能具有两个以上的 boot loader。事实上，boot loader 不仅可以安装在 MBR 中，还可以安装在每个分区的 <strong>开机扇区（boot sector）</strong> 中。</p><p>假设 MBR 中安装的是可以识别 Windows/Linux 的 boot loader，那么整个流程如下图所示：</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-boot-loader.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>由上图可知，MBR 的 boot loader 提供两个菜单选项：选项 1（M1）可以直接载入 Windows 的核心文件进行开机；选项二（M2）可以将开机管理任务交给第二个分区的开机扇区（boot sector）。如果用户选择选项 2，第二分区的开机扇区中的 boot loader 将会载入 Linux 的核心文件进行开机。</p><blockquote><p>关于多系统安装 Linux 安装时，可以将 boot loader 安装在 MBR 或其他分区的开机扇区，Linux 的 boot loader 可以手动设置菜单（即上图的 M1、M2），因此可在 Linux 的 boot loader 中加入 Windows 开机的选项 Windows 安装时，其安装程序会主动覆盖 MBR 以及自己所在分区的开机扇区，并且没有选择的机会，也没有让用户自己选择的菜单的功能 结论：安装多系统时应该先安装 Windows 系统</p></blockquote><h2 id="guid-分区表" tabindex="-1"><a class="header-anchor" href="#guid-分区表"><span>GUID 分区表</span></a></h2><p>MBR 主要有以下限制：</p><ul><li>操作系统无法寻址容量超过 2.2TB 的磁盘</li><li>MBR 只有一个区块，若被破坏后，很难对数据进行恢复</li><li>MBR 的引导程序所能使用空间只有 446 Byte，无法容纳更多的代码</li></ul><p>GUID 则解决了 MBR 的这些问题。</p><p>下图所示为 GUID 的结构示意图。与 MBR 使用扇区作为寻址单位不同，GUID 使用 <strong>逻辑区块（Logical Block）</strong> 作为寻址单位，即采用 LBA（Logical Block Address）寻址方式。MRB 仅使用第一个扇区 512 Bytes 的空间记录分区信息，GUID 则使用 34 个 LBA 区块（每个区块容量默认为 512 Bytes）记录分区信息。MBR 仅有一个扇区保存分区信息，GUID 除了使用硬盘前 34 个 LBA，还是用最后 33 个 LBA 作为备份。</p><p>这里有个疑问：为何前面使用 34 个 LBA，后面使用 33 个 LBA。因为第一个 LBA（LBA0）是用来兼容 MBR 的。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/disk-guid-partition-table.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="lba0-mbr-兼容区块" tabindex="-1"><a class="header-anchor" href="#lba0-mbr-兼容区块"><span>LBA0（MBR 兼容区块）</span></a></h3><p>LBA0 为了兼容 MBR，该区块也分为两个部分，分别用于存储 MBR 分区表和引导程序。因为LBA0 是针对 MBR 兼容模式，因此其分区表中仅仅存放一个特殊标志的分区表信息，用来标识此硬盘为 LBA 寻址方式。</p><h3 id="lba1-guid-分区表表头" tabindex="-1"><a class="header-anchor" href="#lba1-guid-分区表表头"><span>LBA1（GUID 分区表表头）</span></a></h3><p>LBA1 记录了分区表本身的位置和大小，同时记录了备份分区表的位置（即最后 33 个 LBA）。此外还存放了分区表的校验码（CRC32），表示硬盘的完整性。</p><h3 id="lba2-33-分区表表项" tabindex="-1"><a class="header-anchor" href="#lba2-33-分区表表项"><span>LBA2~33（分区表表项）</span></a></h3><p>从 LBA2 开始，每个 LBA 都可以记录 4 组分区信息。默认情况下，总共可以有 4 * 32 = 128 组分区信息。因为每个 LBA 有 512 Bytes，所以每组分区信息可使用 128 Bytes 的空间。这 128 Bytes 的分区信息中，分别提供了 64 Bits 用于记录分区对应的 <strong>起始/结束</strong> 区块号。因此，GUID 能够支持的硬盘的最大容量为 <code>2^64 * 512Byte = 233 TB</code></p><h1 id="硬盘格式化" tabindex="-1"><a class="header-anchor" href="#硬盘格式化"><span>硬盘格式化</span></a></h1><p>我们知道，一个硬盘必须要经过格式化之后才能使用。那么，格式化到底做了什么呢？</p><p>本质上，硬盘格式化可以分为两个步骤，分别是：</p><ul><li><strong>低级格式化</strong>，或称 <strong>物理格式化</strong>。</li><li><strong>高级格式化</strong>，或称 <strong>逻辑格式化</strong>。</li></ul><h2 id="低级格式化" tabindex="-1"><a class="header-anchor" href="#低级格式化"><span>低级格式化</span></a></h2><p>在 <a href="http://chuquan.me/2019/04/05/linux-disk-introduce/" target="_blank" rel="noopener noreferrer">《计算机那些事(1)——硬盘》</a> 一文中，我们介绍了硬盘的两种寻址方式，分别是：</p><ul><li><strong>CHS 寻址方式</strong>：由柱面数（Cylinders）、磁头数（Headers）、扇区数（Sectors）组成 3D 参数，简称 CHS 寻址方式，硬盘容量相对较小。如传统的机械硬盘（Hard Disk Drive，HDD）。</li><li><strong>LBA 寻址方式</strong>：线性寻址，以逻辑区块为单位进行寻址，全称为 Logic Block Address（即扇区的逻辑块地址），硬盘容量相对较大。如固态硬盘（Solid State Disk，SSD）</li></ul><p>对于 CHS 硬盘，低级格式化会对硬盘进行划分柱面、磁道、扇区的操作，也称为 <strong>扇区初始化</strong>。一般由硬盘制造商进行低级格式化。</p><p>对于 LBA 硬盘，并不存在低级格式化，因为 LBA 寻址的硬盘使用集成电路替代物理旋转磁盘，主要由主控和闪存芯片组成。</p><p>低级格式化完成后，硬盘控制器即可使用格式化的结果。</p><h2 id="高级格式化" tabindex="-1"><a class="header-anchor" href="#高级格式化"><span>高级格式化</span></a></h2><p>相对而言，低级格式化是在硬件层面进行初始化，而高级格式化则是在软件层面进行初始化。</p><p>高级格式化一般会有两个步骤：</p><ul><li><strong>硬盘分区初始化</strong>：在硬盘的特定区域写入特定的数据，即重写分区表。关于硬盘分区的细节，可以阅读 <a href="http://chuquan.me/2019/04/05/linux-disk-introduce/" target="_blank" rel="noopener noreferrer">《计算机那些事(1)——硬盘》</a>。</li><li><strong>文件系统初始化</strong>：根据用户选定的文件系统（如：FAT、NTFS、EXT2、EXT3 等），在特定分区中规划一系列表结构进行逻辑区块管理等。</li></ul><p>通常，一个硬盘可以被划分为多个分区。传统的硬盘，每个分区只能初始化一种文件系统。现代的 LVM 与 RAID 技术则能够支持将一个分区格式化为多个文件系统，也支持将多个分区合并成一个文件系统。</p><h2 id="软硬件映射" tabindex="-1"><a class="header-anchor" href="#软硬件映射"><span>软硬件映射</span></a></h2><p>在硬件层面，对于 CHS 硬盘，最小的物理存储单元是扇区，大小为 512 byte；对于 LBA 硬盘，最小的物理存储单元是闪存（本质是晶体管），大小为 1 bit。</p><p>在软件层面，为了与操作系统的页大小对齐，文件系统定义的逻辑区块大小一般为 1K、2K 或 4K。</p><p>下图所示，为文件系统逻辑区块与硬盘物理区块之间的映射关系。对于 CHS 硬盘，一个逻辑区块所对应的物理区块可能由多个扇区组成。对于 LBA 硬盘，一个逻辑区块则对应一片集成电路存储单元。</p><p>在通信时，首先由文件系统的 I/O 管理器将逻辑区块转换成物理区块地址，然后由硬盘控制器根据物理区块（扇区）地址，进行数据读写。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-map.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h1 id="文件系统类型" tabindex="-1"><a class="header-anchor" href="#文件系统类型"><span>文件系统类型</span></a></h1><p>常见的文件系统类型非常多，比如：</p><ul><li>CentOS 5/6 默认使用 ext2/ext3/ext4</li><li>CentOS 7 默认使用 xfs</li><li>Windows 默认使用 NTFS</li><li>MacOS、iOS、watchOS 默认使用 APFS（曾经使用 HFS）</li></ul><p>虽然文件系统的种类很多，但是它们的底层实现大同小异。本文，我们来聊一聊 Linux 系统下的默认文件系统——Ext 文件系统族，举一反三，从而来理解文件系统的底层设计。</p><h1 id="文件系统结构" tabindex="-1"><a class="header-anchor" href="#文件系统结构"><span>文件系统结构</span></a></h1><p>以 Linux 经典的 Ext2 文件系统进行分析，其整体结构如下图所示。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-01.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>从宏观角度来看，文件系统将硬盘分为两部分：</p><ul><li><strong>引导区块（Boot Block）</strong></li><li><strong>区块组（Block Groups）</strong></li></ul><h2 id="boot-block" tabindex="-1"><a class="header-anchor" href="#boot-block"><span>Boot Block</span></a></h2><p>引导区块是分区的第一个区块，当然，并不是所有分区都有引导区块，只有安装了操作系统的主分区和逻辑分区才有引导区块。</p><p>引导区块存储了 Boot Loader，当系统加电启动时，Boot Loader 会被引导装载并执行，从而最终启动操作系统。</p><h2 id="block-groups" tabindex="-1"><a class="header-anchor" href="#block-groups"><span>Block Groups</span></a></h2><p>文件系统的另一主要组成是区块组，ext2 文件系统包含多个区块组，那么为什么要划分那么多区块组呢？事实上，如果直接管理逻辑区块，逻辑区块的数量是非常庞大的，难以管理，因此为了简化，划分出了区块组，从而进行分级管理。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-02.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>上图所示，区块组内部又可以分成多个部分，分别是：</p><ul><li><strong>超级区块（Super Block）</strong></li><li><strong>组描述符表（Group Descriptor Table，GDT）</strong></li><li><strong>区块位图（Block Bitmap）</strong></li><li><strong>索引节点位图（Inode Bitmap）</strong></li><li><strong>索引节点表（Inode Table）</strong></li><li><strong>数据区块（Data Blocks）</strong></li></ul><blockquote><p>注意<br><strong>区块组的 “区块” 对应的文件系统的逻辑区块。区块组中的各个组成部分都使用 “区块” 作为载体进行存储</strong>。</p></blockquote><p>下面，我们将分别介绍区块组的各个组成部分。</p><h1 id="block-inode" tabindex="-1"><a class="header-anchor" href="#block-inode"><span>Block &amp; Inode</span></a></h1><p>在介绍区块组的各个组成部分之前，我们先来了解一下 Block 和 Inode。</p><h2 id="block" tabindex="-1"><a class="header-anchor" href="#block"><span>Block</span></a></h2><p>Block 主要用于 <strong>存储文件的内容数据</strong>。不同大小的 Block 使得文件系统能够支持的最大容量和最大单一文件大小各不相同，其限制如下所示：</p><table><thead><tr><th>Block size</th><th>1KB</th><th>2KB</th><th>4KB</th></tr></thead><tbody><tr><td>最大单一文件限制</td><td>16GB</td><td>256GB</td><td>2TB</td></tr><tr><td>最大文件系统容量</td><td>2TB</td><td>8TB</td><td>16TB</td></tr></tbody></table><p>Block 有一些基本限制，如下：</p><ul><li>Block 的大小和数量在格式化后无法改变。</li><li>一个 Block 只能存放一个文件的数据。</li><li>如果文件大于 Block 的大小，则一个文件会占用多个 Block。</li><li>如果文件小于 Block 的大小，则 Block 中多余的容量将无法再被使用。</li></ul><h2 id="inode" tabindex="-1"><a class="header-anchor" href="#inode"><span>Inode</span></a></h2><p>上述，我们提到了一个大文件会占用多个 Block，那么，文件系统是如何判断哪些 Block 是属于同一个文件的呢？答案就是索引节点（index node，inode）。</p><p>Inode 主要用于 <strong>存储文件的属性元数据</strong>，其记录的信息包括：</p><ul><li>文件的类型</li><li>文件的权限：read/write/execute</li><li>文件的拥有者：owner</li><li>文件的群组：group</li><li>文件的容量</li><li>文件的创建时间：ctime</li><li>文件的最近读取时间：atime</li><li>文件的最近修改时间：mtime</li><li>文件的内容指针：<strong>即指向属于文件的 Block 的指针</strong></li><li>...</li></ul><blockquote><p>注意<br> Inode 并不包含文件名，文件名则存储在 <strong>目录项</strong> 中，详细信息可见下文。</p></blockquote><p>根据 inode 中存储的文件内容指针，文件系统就能找到哪些 Block 是属于该文件的。</p><p>在高级格式化时，inode 的数量和大小就已经固定下来了，其大小一般为 128 byte 或 256 byte。同样，inode 也有一些基本限制，如下：</p><ul><li>一个文件只会占用一个 inode。</li><li>文件系统支持的最大文件数量与 inode 的相关。</li><li>文件系统读取文件时，判断对应 inode 的权限与使用者是否符合，如果符合才能读取 Block 的数据。</li></ul><p>如下所示为 ext2 中 inode 的数据结构定义。<strong>注意，inode 的定义并没有 inode id，那么这种情况下如何索引 inode 呢</strong>？关于这个问题，我们在 Inode Table 一节进行解释。</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>1 <br>2 <br>3 <br>4 <br>5 <br>6 <br>7 <br>8 <br>9 <br>10 <br>11 <br>12 <br>13 <br>14 <br>15 <br>16 <br>17 <br>18 <br>19 <br>20 <br>21 <br>22 <br>23 <br>24 <br>25 <br>26 <br>27 <br>28 <br>29 <br>30 <br>31 <br>32 <br>33 <br>34 <br>35 <br>36 <br>37 <br>38 <br>39 <br>40 <br>41 <br>42 <br>43 <br>44 <br>45 <br>46 <br>47 <br>48 <br>49 <br>50 <br>51 <br>52 <br>53 <br>54</td><td>/* linux/fs/ext2/ext2.h <em>/ <br>struct ext2_inode { <br> __le16 i_mode; /</em> File mode <em>/ <br> __le16 i_uid; /</em> Low 16 bits of Owner Uid <em>/ <br> __le32 i_size; /</em> Size in bytes <em>/ <br> __le32 i_atime; /</em> Access time <em>/ <br> __le32 i_ctime; /</em> Creation time <em>/ <br> __le32 i_mtime; /</em> Modification time <em>/ <br> __le32 i_dtime; /</em> Deletion Time <em>/ <br> __le16 i_gid; /</em> Low 16 bits of Group Id <em>/ <br> __le16 i_links_count; /</em> Links count <em>/ <br> __le32 i_blocks; /</em> Blocks count <em>/ <br> __le32 i_flags; /</em> File flags <em>/ <br> union { <br> struct { <br> __le32 l_i_reserved1; <br> } linux1; <br> struct { <br> __le32 h_i_translator; <br> } hurd1; <br> struct { <br> __le32 m_i_reserved1; <br> } masix1; <br> } osd1; /</em> OS dependent 1 <em>/ <br> __le32 i_block[EXT2_N_BLOCKS]; /</em> Pointers to blocks <em>/ <br> __le32 i_generation; /</em> File version (for NFS) <em>/ <br> __le32 i_file_acl; /</em> File ACL <em>/ <br> __le32 i_dir_acl; /</em> Directory ACL <em>/ <br> __le32 i_faddr; /</em> Fragment address <em>/ <br> union { <br> struct { <br> __u8 l_i_frag; /</em> Fragment number <em>/ <br> __u8 l_i_fsize; /</em> Fragment size <em>/ <br> __u16 i_pad1; <br> __le16 l_i_uid_high; /</em> these 2 fields <em>/ <br> __le16 l_i_gid_high; /</em> were reserved2[0] <em>/ <br> __u32 l_i_reserved2; <br> } linux2; <br> struct { <br> __u8 h_i_frag; /</em> Fragment number <em>/ <br> __u8 h_i_fsize; /</em> Fragment size <em>/ <br> __le16 h_i_mode_high; <br> __le16 h_i_uid_high; <br> __le16 h_i_gid_high; <br> __le32 h_i_author; <br> } hurd2; <br> struct { <br> __u8 m_i_frag; /</em> Fragment number <em>/ <br> __u8 m_i_fsize; /</em> Fragment size <em>/ <br> __u16 m_pad1; <br> __u32 m_i_reserved2[2]; <br> } masix2; <br> } osd2; /</em> OS dependent 2 */ <br>};</td></tr></tbody></table><h3 id="文件系统预留-inode" tabindex="-1"><a class="header-anchor" href="#文件系统预留-inode"><span>文件系统预留 Inode</span></a></h3><p>Ext 文件系统预留了一部分 Inode 作为特殊用途，如下所示。</p><table><thead><tr><th>Inode</th><th>用途</th></tr></thead><tbody><tr><td>0</td><td>不存在，可用于标识目录的 Data Block 中已删除的文件</td></tr><tr><td>1</td><td>虚拟文件系统，如：<code>/proc</code>、<code>/sys</code></td></tr><tr><td>2</td><td>根目录EXT家族为2，XFS为128</td></tr><tr><td>3</td><td>ACL 索引</td></tr><tr><td>4</td><td>ACL 数据</td></tr><tr><td>5</td><td>Boot Loader</td></tr><tr><td>6</td><td>未删除的目录</td></tr><tr><td>7</td><td>预留的区块组描述符 Inode</td></tr><tr><td>8</td><td>日志 Inode</td></tr><tr><td>11</td><td>第一个非预留的 Inode，通常是 <code>lost+fount</code> 目录</td></tr></tbody></table><h1 id="区块组结构" tabindex="-1"><a class="header-anchor" href="#区块组结构"><span>区块组结构</span></a></h1><h2 id="data-blocks" tabindex="-1"><a class="header-anchor" href="#data-blocks"><span>Data Blocks</span></a></h2><p>Data Blocks 包含了区块组中剩余的所有 Block。Block 的数量在高级格式化完成后就已经确定下来了。</p><h2 id="block-bitmap-区块对照表" tabindex="-1"><a class="header-anchor" href="#block-bitmap-区块对照表"><span>Block Bitmap(区块对照表)</span></a></h2><p>Block Bitmap 用于标识区块组中所有的 Block 的使用状态，其使用 1 bit 来表示：0 表示空闲，1 表示占用。</p><p>区块组使用一个 Block 存储 Block Bitmap。如果 Block 的大小为 4K，那么其总共有 4 x 1024 x 8 = 32768 个比特位，可用于描述可使用的 Block。</p><p>注意，Block Bitmap 只在写数据时使用，因为只有写数据才需要找到空闲的 Block。</p><h2 id="inode-table" tabindex="-1"><a class="header-anchor" href="#inode-table"><span>Inode Table</span></a></h2><p>Inode Table 包含了区块组中所有的 Inode。Inode 的数量在高级格式化完成后就已经确定下来了。</p><p>如果 Block 的大小为 4K 且 inode 的大小为 256 byte，那么一个 Block 可以存储 4 x 1024 / 256 = 16 个 inode。区块组中的 Inode Table 通过占用了多个连续的 Block，在逻辑上形成一张表记录了所有 inode，如下图所示。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-03.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>根据上述原理，当给定一个 inode id 时，我们只需要结合 inode 数据结构的大小，在这个 Inode Table 中查找到对应项即可找到对应的 inode。这也就解释了为什么 inode 没有 inode id 也能找到 inode 的原因。</p><p><img src="/assets/images/Linux 磁盘与文件系统管理-inode结构示意图.png" alt="" loading="lazy"><br> 上图最左边为 inode 本身 (128 bytes)，里面有 12 个直接指向 block 号码的对照，这 12 笔记录就能够直接取得 block 号码啦！ 至于所谓的间接就是再拿一个 block 来当作记录 block 号码的记录区，如果文件太大时， 就会使用间接的 block 来记录编号。如上图 1.3.2 当中间接只是拿一个 block 来记录额外的号码而已。 同理，如果文件持续长大，那么就会利用所谓的双间接，第一个 block 仅再指出下一个记录编号的 block 在哪里， 实际记录的在第二个 block 当中。依此类推，三间接就是利用第三层 block 来记录编号啦！<br> 这样子 inode 能够指定多少个 block 呢？我们以较小的 1K block 来说明好了，可以指定的情况如下：</p><ul><li>12 个直接指向： 12*1K=12K<br> 由于是直接指向，所以总共可记录 12 笔记录，因此总额大小为如上所示；</li><li>间接： 256*1K=256K<br> 每笔 block 号码的记录会花去 4bytes，因此 1K 的大小能够记录 256 笔记录，因此一个间接可以记录的文件大小如上；</li><li>双间接： 256*256*1K=2562K<br> 第一层 block 会指定 256 个第二层，每个第二层可以指定 256 个号码，因此总额大小如上；</li><li>三间接： 256*256*256*1K=2563K<br> 第一层 block 会指定 256 个第二层，每个第二层可以指定 256 个第三层，每个第三层可以指定 256 个号码，因此总额大小如上；</li><li>总额：将直接、间接、双间接、三间接加总，得到 12 + 256 + 256*256 + 256*256*256 (K) = 16GB</li></ul><h2 id="inode-bitmap" tabindex="-1"><a class="header-anchor" href="#inode-bitmap"><span>Inode Bitmap</span></a></h2><p>Inode Bitmap 用于标识区块组中所有的 inode 的使用状态，其使用 1 bit 来表示：0 表示空闲，1 表示占用。</p><p>区块组使用一个 Block 存储 Inode Bitmap。如果 Block 的大小为 4K，那么其总共有 4 x 1024 x 8 = 32768 个比特位，可用于描述可使用的 inode。</p><h2 id="filesystem-description-gdt文件系统描述说明" tabindex="-1"><a class="header-anchor" href="#filesystem-description-gdt文件系统描述说明"><span>Filesystem Description ( GDT文件系统描述说明)</span></a></h2><p>这个区段可以描述每个 block group 的开始与结束的 block 号码，以及说明每个区段 (superblock, bitmap, inodemap, data block) 分别介于哪一个 block 号码之间。这部份也能够用 <a href="http://cn.linux.vbird.org/linux_basic/0230filesystem.php#dumpe2fs" target="_blank" rel="noopener noreferrer">dumpe2fs</a> 来观察的。</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* linux/fs/ext2/ext2.h */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ext2_group_desc {  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	bg_block_bitmap;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* Blocks bitmap block */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	bg_inode_bitmap;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* Inodes bitmap block */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	bg_inode_table;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		    /* Inodes table block */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	bg_free_blocks_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	/* Free blocks count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	bg_free_inodes_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	/* Free inodes count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	bg_used_dirs_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	    /* Directories count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	bg_pad;  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">bg_reserved</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>区块组使用连续的 Block 记录了文件系统中所有区块组的组描述符，从而在逻辑上形成一张表，即 Group Descriptor Table（简称 GDT），如下图所示。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-04.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这里会有一个疑问，为什么区块组中存储了一个描述整个文件系统区块组的信息？很多区块组都存储了内容重复的 GDT，这样是否会造成存储空间的浪费？其实这么做的原因是为了进行 <strong>备份</strong>，如果只在某片区域存储这部分信息，一旦这片存储区域出现了损坏，那么将导致整个文件系统无法使用并且无法恢复。</p><h2 id="super-block" tabindex="-1"><a class="header-anchor" href="#super-block"><span>Super Block</span></a></h2><p>类似于 GDT，Super Block 也是一个描述文件系统整体的数据结构，其存储在区块组中也是为了备份。</p><p><strong>Super Block 是文件系统的核心</strong>，其保存了 <strong>文件系统的所有元数据</strong>，比如：</p><ul><li>Block 和 Inode 的总量</li><li>空闲/占用的 Block 和 Inode 的数量</li><li>Block 和 Inode 的大小</li><li>文件系统的挂载时间</li><li>文件系统的最近写入时间</li><li>一个 valid bit 数值，若此文件系统已被挂载，则 valid bit 为 0 ，若未被挂载，则 valid bit 为 1 。</li><li>...</li></ul><blockquote><p>每个区块组（block group）都可能含有超级区块。除了第一个block group 内会含有 superblock 之外，后续的 block group 不一定含有 superblock ， 而若含有 superblock 则该 superblock 主要是做为第一个 block group 内 superblock 的备份，这样可以进行超级区块的恢复。</p></blockquote><p>如下所示为 ext2 中 Super Block 的数据结构定义。</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">/* linux/fs/ext2/ext2.h */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ext2_super_block {  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_inodes_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* Inodes count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_blocks_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* Blocks count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_r_blocks_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Reserved blocks count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_free_blocks_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	            /* Free blocks count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_free_inodes_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	            /* Free inodes count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_first_data_block;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* First Data Block */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_log_block_size;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Block size */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_log_frag_size;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Fragment size */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_blocks_per_group;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* # Blocks per group */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_frags_per_group;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* # Fragments per group */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_inodes_per_group;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* # Inodes per group */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_mtime;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                    /* Mount time */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_wtime;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                    /* Write time */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_mnt_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* Mount count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_max_mnt_count;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Maximal mount count */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_magic;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                    /* Magic signature */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_state;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                    /* File system state */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_errors;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                    /* Behaviour when detecting errors */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_minor_rev_level;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	                /* minor revision level */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_lastcheck;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* time of last check */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_checkinterval;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* max. time between checks */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_creator_os;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* OS */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_rev_level;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* Revision level */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_def_resuid;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* Default uid for reserved blocks */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_def_resgid;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* Default gid for reserved blocks */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	/*  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * These fields are for EXT2_DYNAMIC_REV superblocks only.  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 *  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * Note: the difference between the compatible feature set and  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * the incompatible feature set is that if there is a bit set  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * in the incompatible feature set that the kernel doesn&#39;t  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * know about, it should refuse to mount the filesystem.  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 *   </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * e2fsck&#39;s requirements are more strict; if it doesn&#39;t know  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * about a feature in either the compatible or incompatible  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * feature set, it must abort and not try to meddle with  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * things it doesn&#39;t understand...  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_first_ino;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 		                /* First non-reserved inode */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16  s_inode_size;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 		                /* size of inode structure */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	s_block_group_nr;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	                /* block group # of this superblock */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_feature_compat;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	                /* compatible feature set */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_feature_incompat;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	            /* incompatible feature set */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_feature_ro_compat;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	            /* readonly-compatible feature set */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">s_uuid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                    /* 128-bit uuid for volume */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	char</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	s_volume_name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	                /* volume name */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	char</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	s_last_mounted</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">64</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	            /* directory where last mounted */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_algorithm_usage_bitmap;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">           /* For compression */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	/*  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * Performance hints.  Directory preallocation should only  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * happen if the EXT2_COMPAT_PREALLOC flag is on.  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	s_prealloc_blocks;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Nr of blocks to try to preallocate*/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	s_prealloc_dir_blocks;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	            /* Nr to preallocate for dirs */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u16	s_padding1;  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	/*  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 * Journaling support valid if EXT3_FEATURE_COMPAT_HAS_JOURNAL set.  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	 */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">s_journal_uuid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* uuid of journal superblock */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u32	s_journal_inum;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* inode number of journal file */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u32	s_journal_dev;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* device number of journal file */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u32	s_last_orphan;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* start of list of inodes to delete */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u32	</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">s_hash_seed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		                /* HTREE hash seed */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	s_def_hash_version;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Default hash version to use */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	s_reserved_char_pad;  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u16	s_reserved_word_pad;  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	s_default_mount_opts;  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> 	__le32	s_first_meta_bg;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> 	                /* First metablock block group */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u32	</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">s_reserved</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">190</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	                /* Padding to the end of the block */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="文件存储" tabindex="-1"><a class="header-anchor" href="#文件存储"><span>文件存储</span></a></h1><p>在了解了文件系统的底层结构之后，我们再来看看不同类型的文件在文件系统中是如何存储的。</p><h2 id="普通文件存储" tabindex="-1"><a class="header-anchor" href="#普通文件存储"><span>普通文件存储</span></a></h2><blockquote><p>当我们在 Linux 下的 ext2 建立一个一般文件时， ext2 会分配一个 inode 与相对于该文件大小的block 数量给该文件。例如：假设我的一个 block 为 4 Kbytes ，而我要建立一个 100 KBytes 的文件，那么 linux 将分配一个 inode 与 25 个 block 来储存该文件！ 但同时请注意，由于 inode 仅有 12 个直接指向，因此还要多一个 block 来作为区块号码的记录</p></blockquote><p>在讨论普通文件存储时，我们可以根据普通文件大小分为两种类型：</p><ul><li>小文件存储：占用 Block 数量小于 <code>EXT2_N_BLOCKS</code></li><li>大文件存储：占用 Block 数量大于 <code>EXT2_N_BLOCKS</code></li></ul><p>对于小文件存储，其基本原理是：根据 inode 的 <code>i_block[]</code> 数组中保存的 Block 指针（Block 序号），找到对应所有的 Block 即可，如下所示。</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-小文件占用block.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>对于大文件存储，由于一个 inode 可引用的 Block 数量的上限是 <code>EXT2_N_BLOCKS</code>，因此可以使用 Data Block 存储间接的 inode，从而扩大最终可引用的 Block 数量，如下所示。</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-大文件占用block.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="目录文件存储" tabindex="-1"><a class="header-anchor" href="#目录文件存储"><span>目录文件存储</span></a></h2><blockquote><p>当我们在 Linux 下的文件系统建立一个目录时，文件系统会分配一个 inode 与至少一块 block 给该目录。其中，inode 记录该目录的相关权限与属性，并可记录分配到的那块 block 号码； 而 block 则是记录在这个目录下的文件名与该文件名占用的 inode 号码数据。</p></blockquote><p>也就是说目录所占用的 block 内容在记录如下的信息</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-目录内存分布.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>目录文件的 <strong>内容数据</strong> 是由一系列 <strong>目录项</strong> 组成。Ext2 文件系统中目录项的数据结构定义如下所示：</p><div class="language-c line-numbers-mode" data-highlighter="shiki" data-ext="c" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-c"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// linux/include/linux/ext2_fs.h  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> EXT2_NAME_LEN</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 255</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// linux/fs/ext2/ext2.h  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">struct</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ext2_dir_entry_2 {  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le32	inode;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			/* Inode number */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__le16	rec_len;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* Directory entry length */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	name_len;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		/* Name length */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	__u8	file_type;  </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	char</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	name</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">[]</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			/* File name, up to EXT2_NAME_LEN */</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>每一个目录项定义了一个文件所对应的 inode 序号、目录项长度、文件名长度、文件类型等。关于文件类型，ext2 定义了以下这些文件类型。</p><table><thead><tr><th>编码</th><th>文件类型</th></tr></thead><tbody><tr><td>0</td><td>Unknown</td></tr><tr><td>1</td><td>Regular File</td></tr><tr><td>2</td><td>Director</td></tr><tr><td>3</td><td>Character Device</td></tr><tr><td>4</td><td>Block Device</td></tr><tr><td>5</td><td>Named Pipe</td></tr><tr><td>6</td><td>Socket</td></tr><tr><td>7</td><td>Symbolic Link</td></tr></tbody></table><p>以一个 <code>test</code> 目录文件为例，其包含以下这些文件。</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>1 <br>2 <br>3 <br>4 <br>5 <br>6 <br>7 <br>8</td><td>$ ls -la test/ <br>total 20 <br>drwxr-xr-x 3 baochuquan staff 4096 Apr 24 12:12 . <br>drwxrwxrwt 13 baochuquan staff 8192 Apr 24 12:12 .. <br>brw-r--r-- 1 baochuquan staff 3, 0 Apr 24 12:12 harddisk <br>lrwxrwxrwx 1 baochuquan staff 14 Apr 24 12:12 linux -&gt; /usr/src/linux <br>-rw-r--r-- 1 baochuquan staff 13 Apr 24 12:12 sample <br>drwxr-xr-x 2 baochuquan staff 4096 Apr 24 12:12 sources</td></tr></tbody></table><p><code>test</code> 目录文件在文件系统中的 <strong>内容数据</strong> 的存储如下所示。</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-目录内存示意图如.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>这里需要重点注意是 <code>rec_len</code>，<code>rec_len</code> 表示 <strong>从当前目录项的 <code>rec_len</code> 末尾开始，到下一个目录项的 <code>rec_len</code> 末尾结束的偏移量字节数</strong>。当文件系统从目录文件中删除某一个子目录时，比如 <code>deldir</code> 目录，这时候并不会删除对应的目录项，仅仅是修改删除项之前目录项的 <code>rec_len</code> 值，从而使得文件系统在扫描目录内容时，跳过 <code>deldir</code> 目录项。这也是为什么图中 <code>deldir</code> 之前的目录项的 <code>rec_len</code> 为 32。</p><h2 id="软链接存储-符号链接symbolic-link" tabindex="-1"><a class="header-anchor" href="#软链接存储-符号链接symbolic-link"><span>软链接存储(符号链接Symbolic link)</span></a></h2><p>软链接，即符号链接，类似于 Windows 操作系统中的快捷方式，它的作用是指向原文件或目录。</p><p>软链接一般情况下不占用 Data Block，仅仅通过它对应的 inode 完成信息记录，只有当目标路径占用的字符数超过 60 字节时，文件系统才会分配一个 Data Block 来存储目标路径。</p><p>注意，软链接的 Data Block 存储的是 <strong>目标文件名</strong>，比如：<code>nox -&gt; /Users/baochuquan/Develop/nox/nox.sh</code> 中 <code>/Users/baochuquan/Develop/nox/nox.sh</code> 即目标路径, 当来源档被删除之后，symbolic link 的文件会开不了</p><p>举例来说，我们先建立一个符号链接文件链接到 /etc/crontab</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ln -s /etc/crontab crontab2</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ll -i /etc/crontab /root/crontab2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">34474855</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 451</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/crontab</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">53745909</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lrwxrwxrwx.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 23</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 22:31</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /root/crontab2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/etc/crontab</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由上表的结果我们可以知道两个文件指向不同的 inode 号码，当然就是两个独立的文件存在！ 而且<br> 连结档的重要内容就是他会写上目标文件的『文件名』，你可以发现为什么上表中连结档的大小为 12<br> bytes 呢？ 因为箭头(--&gt;)右边的档名『/etc/crontab』总共有 12 个英文，每个英文占用 1 个 bytes ，<br> 所以文件大小就是 12bytes 了！</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-符号链接文件读取示意图.png" alt="|800" tabindex="0" loading="lazy"><figcaption>|800</figcaption></figure><p>由 1 号 inode 读取到连结档的内容仅有档名，根据档名链接到正确的目录去取得目标文件的 inode ，<br> 最终就能够读取到正确的数据了。你可以发现的是，如果目标文件(/etc/crontab)被删除了，那么整个<br> 环节就会无法继续进行下去， 所以就会发生无法透过连结档读取的问题了！</p><p>Symbolic Link 与 Windows 的快捷方式可以给他划上等号，由 Symbolic link 所建立的文件为一个独立的新的文件，所以会占用掉 inode 与 block</p><h2 id="硬链接存储" tabindex="-1"><a class="header-anchor" href="#硬链接存储"><span>硬链接存储</span></a></h2><p>文件名只与目录有关，文件内容则与 inode 有关。</p><ul><li>每个文件都会占用一个 inode ，文件内容由 inode 的记录来指向；</li><li>文件名以及文件inode的映射关系表在所属目录中保存</li><li>想要读取该文件，必须要经过目录记录的文件名来指向到正确的 inode 号码才能读取。</li></ul><p>通过上文，我们知道目录项存储了 inode 序号、文件名等信息。假如，有两个目录项存储了不同的文件名，但它们的 inode 序号却相同，这会是一种什么样的情况呢？事实上，这就是硬链接，即 inode 相同的文件。</p><p>简单的说：hard link 只是在某个目录下新增一笔文件名链接到某 inode 号码的关连记录而已。</p><p>例如：假设我系统有个 /root/crontab 他是 /etc/crontab 的实体链接，也就是说这两个档名连<br> 结到同一个 inode ， 自然这两个文件名的所有相关信息都会一模一样(除了文件名之外)。实际的情<br> 况可以如下所示：<br><img src="/assets/images/Linux 磁盘与文件系统管理-hardlink举例.png" alt="|800" loading="lazy"></p><p>透过 1 或 2 的目录之 inode 指定的 block 找到两个不同的档名，而不管使用哪个档名均可以指到 real 那个 inode 去读取到最终数据，如果你将任何一个『档名』删除，其实 inode 与 block 都还是存在的，只不过链接数减一，直至链接数减到0才删除，使用 hard link 设定链接文件时，磁盘的空间与 inode 的数目都不会改变，图中可以知道， hard link 只是在某个目录下的 block 多写入一个关连数据而已，既不会增加 inode 也不会耗用 block 数量</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-hardlink读取示意图.png" alt="|800" tabindex="0" loading="lazy"><figcaption>|800</figcaption></figure><figure><img src="/assets/images/Linux 磁盘与文件系统管理-硬链接.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>与编程语言中的引用计数类似，inode 也是用一个字段 <code>i_links_count</code> 来记录其被引用的数量。</p><ul><li>当创建一个文件的硬链接时，对应的 inode 的链接数会加 1；</li><li>当删除一个文件时，如果对应的 inode 的链接数大于 1 时，则仅仅对链接数进行减 1 操作；如果对应的 inode 的链接数等于 1 时，则会删除 inode 中的 Block 指针。</li></ul><h3 id="目录的硬链接数量" tabindex="-1"><a class="header-anchor" href="#目录的硬链接数量"><span>目录的硬链接数量</span></a></h3><p>在创建目录的同时，文件系统会为它创建两个目录：<code>.</code> 和 <code>..</code>，分别对应当前目录的硬链接、上级目录的硬链接。因此，每一个目录都会包含这两个硬链接，它包含了两个信息：</p><ul><li>一个不包含子目录的目录文件，其硬链接数量为 2。其一是目录本身，即目录 Data Block 中的 <code>.</code>；其二是父级目录 Data Block 中该目录的目录项。</li><li>一个包含子目录的目录文件，其硬链接数量为 2 + 子目录数。因为每一个子目录都关联一个父级目录的硬链接 <code>..</code>。</li></ul><p>文件系统会自动为目录创建硬链接，该权限未对用户开放，用户无法对目录创建硬链接。因此，硬链接只能对文件创建，不能跨 Filesystem；</p><h1 id="文件操作" tabindex="-1"><a class="header-anchor" href="#文件操作"><span>文件操作</span></a></h1><h2 id="文件读取" tabindex="-1"><a class="header-anchor" href="#文件读取"><span>文件读取</span></a></h2><p>关于文件读取，可以分为两个部分：首先，找到父级目录中关于目标文件的元信息；然后，根据目标文件的元信息找到目标文件的内容数据。整体可以分为如下几个步骤：</p><p>目录树是由根目录开始读起，因此系统透过挂载的信息可以找到挂载点的 inode 号码，此时就<br> 能够得到根目录的 inode 内容，并依据该 inode 读取根目录的 block 内的文件名数据，再一层一层<br> 的往下读到正确的档名。</p><ul><li>step 1：根据 Super Block 和 GDT 找到目标文件的父级目录的区块组</li><li>step 2：根据区块组描述符找到区块组中的 Inode Table</li><li>step 3：根据 Inode 序号，从 Inode Table 中找到父级目录的 Inode</li><li>step 4：根据 Inode 找到父级目录 Data Block</li><li>step 5：遍历父级目录的 Data Block 中的目录项，找到与目标文件名匹配的目录项</li><li>step 6：根据目录项中的 Inode 序号，找到目标文件的 Data Block</li></ul><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-09.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>下面，我们以 <code>cat /var/log/message</code> 命令为例，来介绍一下其具体过程。</p><p>文件系统在查找 <code>/var/log/message</code> 时，会将它转换成 4 个类似的步骤，逐步完成。这 4 个阶段分别是：</p><ul><li>查找根目录 <code>/</code></li><li>查找 <code>/</code> 目录下的 <code>var</code> 子目录</li><li>查找 <code>/var</code> 目录下的 <code>log</code> 子目录</li><li>查找 <code>/var/log</code> 目录下的 <code>message</code> 文件</li></ul><p>在详细介绍这 4 个阶段之前，我们需要知道一个前提：在操作系统启动后， 操作系统会挂载根文件系统，此时 Super Block 和 GDT 会被加载至内存之中。</p><h3 id="查找根目录" tabindex="-1"><a class="header-anchor" href="#查找根目录"><span>查找根目录</span></a></h3><p>上文，我们提到文件系统预留了一些 inode 序号，其中根目录 <code>/</code> 的 inode 序号为 128。因此，可以根据 Super Block 的参数定位到 inode 所在的区块组，结合 GDT 获取到区块组的元信息，即区块描述符。</p><p>根据区块描述符，找到对应的 Inode Table，从而定位到具体的 inode，并根据 <code>i_blocks[]</code> 数组，找到对应的 Data Block。</p><p>此时，我们获取到了根目录 <code>/</code> 的所有信息。</p><h3 id="查找-var-目录" tabindex="-1"><a class="header-anchor" href="#查找-var-目录"><span>查找 <code>var</code> 目录</span></a></h3><p>获取到了根目录 <code>/</code> 的 Data Block 之后，我们可以遍历其中的目录项 <code>dir entry</code>，找到文件名与 <code>var</code> 匹配的目录项。根据目录项中的 inode 序号，结合 Super Block 和 GDT，依次定位到区块组、Inode Table、Inode、Data Block。</p><p>此时，我们获取到了 <code>/var</code> 目录的所有信息。</p><h3 id="查找-log-目录" tabindex="-1"><a class="header-anchor" href="#查找-log-目录"><span>查找 <code>log</code> 目录</span></a></h3><p>获取到了 <code>/var</code> 目录的 Data Block 之后，我们可以遍历其中的目录项，找到文件名与 <code>log</code> 匹配的目录项。根据目录项中的 inode 序号，结合 Super Block 和 GDT，与查找 <code>var</code> 目录一样，也能够定位到区块组、Inode Table、Inode、Data Block。</p><p>此时，我们获取到了 <code>/var/log</code> 目录的所有信息。</p><h3 id="查找-message-文件" tabindex="-1"><a class="header-anchor" href="#查找-message-文件"><span>查找 <code>message</code> 文件</span></a></h3><p>获取到了 <code>/var/log</code> 目录的 Data Block 之后，我们可以遍历其中的目录项，找到文件名与 <code>message</code> 匹配的目录项。根据目录项中的 inode 序号，结合 Super Block 和 GDT，我们最终就能找到文件内存数据所存放的一组 Data Block 中。</p><h2 id="文件删除" tabindex="-1"><a class="header-anchor" href="#文件删除"><span>文件删除</span></a></h2><p>关于文件的删除，我们分别介绍一下 <strong>普通文件</strong> 和 <strong>目录文件</strong> 的删除操作。</p><h3 id="普通文件删除" tabindex="-1"><a class="header-anchor" href="#普通文件删除"><span>普通文件删除</span></a></h3><p>对于普通文件删除，其大致可分为以下几个步骤：</p><ul><li>step 1：找到目标文件 Inode 和 Data Block</li><li>step 2：将 Inode Table 中对应 Inode 中的 Data Block 指针删除（位于 <code>i_blocks[]</code> 中）</li><li>step 3：在 Inode Bitmap 中，将对应 Inode 标记为未使用</li><li>step 4：找到目标文件的父级目录的 Data Block，将与目标文件匹配的目录项删除。具体做法是： <ul><li>修改对应目录项的 inode 序号设置为 0</li><li>修改前一个目录项的 <code>rec_len</code>，使文件系统在扫描时能够跳过被删除的目录项</li></ul></li><li>step 5：在 Block Bitmap 中，将对应的 Block 标记为未使用</li></ul><h3 id="目录文件删除" tabindex="-1"><a class="header-anchor" href="#目录文件删除"><span>目录文件删除</span></a></h3><p>对于目录文件删除，其大致可分为以下几个步骤：</p><ul><li>step 1：找到目录及其目录下的所有文件、子目录、子文件的 Inode 和 Data Block</li><li>step 2：在 Inode Bitmap 中，将所有对应的 Inode 标记为未使用</li><li>step 3：在 Block Bitmap 中，将所有对应的 Block 标记为未使用</li><li>step 4：找到目标目录的父级目录的 Data Block，将与目标目录匹配的目录项删除。</li></ul><p>相比而言，目录文件删除时，需要将子目录和子文件全部删除。</p><h2 id="文件重命名" tabindex="-1"><a class="header-anchor" href="#文件重命名"><span>文件重命名</span></a></h2><p>关于文件的重命名，我们分别介绍一下 <strong>同目录内</strong> 和 <strong>非同目录内</strong> 的重命名操作。</p><h3 id="同目录内重命名" tabindex="-1"><a class="header-anchor" href="#同目录内重命名"><span>同目录内重命名</span></a></h3><p>同目录内重命名，其仅仅是找到目录的 Data Block 中对应的目录项，并将原始文件名修改为目标文件名。</p><h3 id="非同目录内重命名" tabindex="-1"><a class="header-anchor" href="#非同目录内重命名"><span>非同目录内重命名</span></a></h3><p>非同目录内重命名，本质上就是文件移动操作。具体细节，见下一节。</p><h2 id="文件移动" tabindex="-1"><a class="header-anchor" href="#文件移动"><span>文件移动</span></a></h2><p>文件移动，可分两种情况讨论，分别是 <strong>目标路径下有同名文件</strong> 和 <strong>目标路径下无同名文件</strong>。</p><p>假设，我们要将执行 <code>mv /origin/file /target/file</code> 操作。</p><p>如果目标路径下有同名文件，文件移动操作可以分为两部分：</p><ul><li>找到 <code>/origin</code> 目录的 Data Block，将 <code>file</code> 文件的目录项删除。</li><li>找到 <code>/target</code> 目录的 Data Block，将同名文件 <code>file</code> 的目录项的 inode 序号修改为新的 inode 序号。</li></ul><p>如果目标路径下无同名文件，文件移动操作也可以分为两部分：</p><ul><li>找到 <code>/origin</code> 目录的 Data Block，将 <code>file</code> 文件的目录项删除。</li><li>找到 <code>/target</code> 目录的 Data Block，新增一个 <code>file</code> 文件的目录项。</li></ul><p>文件移动本质上就是修改了文件的目录项中 Inode 的指针或新增目录项，因此速度非常快。</p><h1 id="多文件系统" tabindex="-1"><a class="header-anchor" href="#多文件系统"><span>多文件系统</span></a></h1><p>上文所有的内容的前提都是在一个文件系统内完成的，下面，我们在来讨论一下多文件系统的相关内容。</p><h2 id="挂载点的意义-mount-point" tabindex="-1"><a class="header-anchor" href="#挂载点的意义-mount-point"><span>挂载点的意义 (mount point)</span></a></h2><p>每个 filesystem 都有独立的 inode / block / superblock 等信息，这个文件系统要能够链接到目录树才能被我们使用。 将文件系统与目录树结合的动作我们称为『挂载』。<strong>挂载点一定是目录</strong>，该目录为进入该文件系统的<strong>入口</strong>。 因此并不是你有任何文件系统都能使用，必须要『挂载』到目录树的某个目录后，才能够使用该文件系统的。</p><p>举例来说，如果你是依据鸟哥的方法安装你的 CentOS 7.x 的话， 那么应该会有三个挂载点才是，分<br> 别是 /, /boot, /home 三个 (鸟哥的系统上对应的装置文件名为 LVM, LVM, /dev/vda2)。 那如果观察<br> 这三个目录的 inode 号码时，我们可以发现如下的情况：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ls -lid / /boot /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dr-xr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:56</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dr-xr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 41</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于 XFS filesystem 最顶层的目录之 inode 一般为 128 号，因此可以发现 /, /boot, /home为三个不同的 filesystem，根目录下的 . 与 .. 是相同的东西， 因为权限是一模一样</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ls -ild / /. /..</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dr-xr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:56</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dr-xr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 17:56</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dr-xr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> May</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="根文件系统" tabindex="-1"><a class="header-anchor" href="#根文件系统"><span>根文件系统</span></a></h2><p>任何一个文件系统要在 Linux 中正常使用，必须挂载到一个以挂载的文件系统的某个目录下。</p><p>类似于一棵多叉树，操作系统也会有一个根文件系统。根文件系统下某个目录如果挂载了某个文件系统，该目录节点被称为 <strong>一级挂载点</strong>；如果这个挂载的文件系统下的某个目录又挂载了某个文件系统，该目录节点被称为 <strong>二级挂载点</strong>。以此类推。</p><p>举个例子，如果 <code>/dev/sdb1</code> 挂载至根文件系统的 <code>/mydata</code> 目录下，那么 <code>/mydata</code> 就是 <strong>一级挂载点</strong>；如果 <code>/dev/cdrom</code> 又挂载至 <code>/dev/sdb1</code> 文件系统的 <code>/mydata/cdrom</code> 目录下，那么 <code>/mydata/cdrom</code> 就是 <strong>二级挂载点</strong>。</p><h2 id="文件系统挂载" tabindex="-1"><a class="header-anchor" href="#文件系统挂载"><span>文件系统挂载</span></a></h2><p>关于文件系统挂载，我们以 <code>mount /dev/cdrom /mnt</code> 为例，进行介绍。</p><p>在文件系统 <code>/dev/cdrom</code> 挂载至挂载点 <code>/mnt</code> 之前，<code>/mnt</code> 是根文件系统的一个目录，其父级目录 <code>/</code> 的 Data Block 中存储了 <code>/mnt</code> 文件对应的目录项，其中包含了文件元信息，如：Inode 序号、文件名等。</p><p>当文件系统 <code>/dev/cdrom</code> 挂载至挂载点 <code>/mnt</code> 之后，<code>/mnt</code> 变成了另一个文件系统的入口。对于挂载，操作系统具体做了以下这些内容。</p><ul><li>在根文件系统的 Inode Table 中，新增一个 Inode 指向文件系统 <code>/dev/cdrom</code> 中的 Data Block。</li><li>找到根文件系统的 <code>/</code> 目录的 Data Block，将 <code>/mnt</code> 对应的目录项的 Inode 序号修改为新增的 Inode 序号。</li><li>在根文件系统的 Inode Table 中，将原始的 <code>/mnt</code> 的 Inode 标记为暂不可用。</li></ul><p>如下所示，为文件系统挂载操作的示意图。<strong>文件系统挂载完成后，挂载点的元数据和内容数据分别存储在不同的文件系统中</strong>。</p><figure><img src="https://chuquan-public-r-001.oss-cn-shanghai.aliyuncs.com/sketch-images/filesystem-arch-10.png?x-oss-process=image/resize,w_800" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h2 id="文件系统卸载" tabindex="-1"><a class="header-anchor" href="#文件系统卸载"><span>文件系统卸载</span></a></h2><p>关于文件系统卸载，其本质就是挂载的还原操作，它会移除新增的 Inode，并将指针指向原来的 Data Block。同时挂载点所对应的目录项的 Inode 指针也会恢复原来的设置。</p><h2 id="linux-vfs-virtual-filesystem-switch" tabindex="-1"><a class="header-anchor" href="#linux-vfs-virtual-filesystem-switch"><span>Linux VFS (Virtual Filesystem Switch)</span></a></h2><p>整个 Linux 的系统都是透过一个名为 Virtual Filesystem Switch 的核心功能去读取 filesystem 的。 也就是说，整个 Linux 认识的 filesystem 其实都是 VFS 在进行管理.</p><figure><img src="/assets/images/Linux 磁盘与文件系统管理-VFS中间层.png" alt="|500" tabindex="0" loading="lazy"><figcaption>|500</figcaption></figure><p>Linux常见的支持文件系统有：</p><ul><li>传统档案系统：ext2 / minix / MS-DOS / FAT (用vfat 模组) / iso9660 (光碟)等等；</li><li>日志式档案系统： ext3 /ext4 / ReiserFS / Windows&#39; NTFS / IBM&#39;s JFS / SGI&#39;s XFS / ZFS</li><li>网路档案系统： NFS / SMBFS</li></ul><p>想要知道你的 Linux 支持的文件系统有哪些，可以察看底下这个目录：<br><code>[root@study ~]# ls -l /lib/modules/$(uname -r)/kernel/fs</code></p><p>系统目前已加载到内存中支持的文件系统则有：<br><code>[root@study ~]# cat /proc/filesystems</code></p><h1 id="xfs文件系统简介" tabindex="-1"><a class="header-anchor" href="#xfs文件系统简介"><span>XFS文件系统简介</span></a></h1><h3 id="xfs-文件系统的配置" tabindex="-1"><a class="header-anchor" href="#xfs-文件系统的配置"><span>XFS 文件系统的配置</span></a></h3><p>xfs 文件系统在资料的分布上，主要规划为三个部份，一个<!---->、一个文件系统<!----></p><!---->以及一个<!---->。 这三个区域的数据内容如下：<h4 id="资料区-data-section" tabindex="-1"><a class="header-anchor" href="#资料区-data-section"><span>资料区 (data section)</span></a></h4><p>数据区就跟我们之前谈到的 ext 家族一样，包括 inode/data block/superblock 等数据，都放置在这个区块。 这个数据区与 ext 家族的 block group 类似，也是分为多个储存区群组(<strong>allocation groups</strong>) 来分别放置文件系统所需要的数据。 每个储存区群组都包含了 (1)整个文件系统的 superblock、 (2)剩余空间的管理机制、 (3)inode 的分配与追踪。此外，<strong>inode 与 block 都是系统用到时才动态配置产生，所以格式化动作超级快</strong></p><p>与 <strong>ext 家族不同</strong>的是， xfs 的 block 与 inode 有多种不同的容量可供设定，<strong>block 容量可由 512bytes ~ 64K 调配</strong>，不过，Linux 的环境下， 由于内存控制的关系 (页面文件 pagesize 的容量之故)，因此<strong>最高可以使用的 block 大小为 4K</strong> , 高于4K后系统无法挂载。 至于 <strong>inode 容量</strong>可由 256bytes 到 2M 这么大！不过，大概还是<strong>保留 256bytes</strong> 的默认值就很够用了</p><p>总之， xfs 的这个数据区的储存区群组 (allocation groups, AG)，你就将它想成是 ext家族的 block 群组 (block groups) ，只是 inode 与 block 是动态产生，并非一开始于格式化就完成配置的。</p><h4 id="文件系统活动登录区-log-section" tabindex="-1"><a class="header-anchor" href="#文件系统活动登录区-log-section"><span>文件系统活动登录区 (log section)</span></a></h4><p>用来记录文件系统的变化（日志区），文件的变化会在这里记录，直到该变化完整的写入到数据区后， 该笔记录才会被终结。如果文件系统因为某些缘故 (例如最常见的停电) 而损毁时，系统会拿这个登录区块来进行检验，看看系统挂掉之前， 文件系统正在运作些啥动作，以快速的修复文件系统。</p><h4 id="实时运作区-realtime-section" tabindex="-1"><a class="header-anchor" href="#实时运作区-realtime-section"><span>实时运作区 (realtime section)</span></a></h4><p>当有文件要被建立时，xfs 会在这个区段里面找一个到数个的 extent 区块，将文件放置在这个区块内，等到分配完毕后，再写入到 data section 的 inode 与 block 去！ 这个 extent 区块的大小得要在格式化的时候就先指定，最小值是 4K 最大可到 1G。一般非磁盘阵列的磁盘默认为 64K容量，而具有类似磁盘阵列的 stripe 情况下，则建议 extent 设定为与 stripe 一样大较佳。这个extent 最好不要乱动，因为可能会影响到实体磁盘的效能。</p><h3 id="xfs-文件系统的xfs-info命令" tabindex="-1"><a class="header-anchor" href="#xfs-文件系统的xfs-info命令"><span>XFS 文件系统的xfs_info命令</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_info 挂载点|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">分区装置文件名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例一：找出系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 这个挂载点底下的文件系统的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 纪录</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df -Th /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                类型</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    容量</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  已用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  可用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  已用%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    10G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  5.2G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   52%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 没错！可以看得出来是 xfs 文件系统的！来观察一下内容吧！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_info /dev/mapper/centos-root</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">meta-data</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/dev/mapper/centos-root</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> isize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">256</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">4,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> agsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">655360</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> blks</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   attr=2,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> projid32bit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       crc=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        finobt=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=2621440,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> imaxpct=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      swidth=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">naming</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   =version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ascii-ci=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ftype=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      =internal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=2560,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lazy-count=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">realtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   extsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rtextents=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面的输出讯息可以这样解释：</p><ul><li>第1 行里面的isize 指的是inode 的容量，每个有256bytes 这么大。至于agcount 则是前面谈到的储存区群组(allocation group) 的个数，共有4 个， agsize 则是指每个储存区群组具有655360 个block 。配合第4 行的block 设定为4K，因此整个档案系统的容量应该就是4*655360*4K 这么大！</li><li>第2 行里面sectsz 指的是逻辑扇区(sector) 的容量设定为512bytes 这么大的意思。</li><li>第4 行里面的bsize 指的是block 的容量，每个block 为4K 的意思，共有2621440=655360*4 个block 在这个档案系统内。</li><li>第5 行里面的sunit 与swidth 与磁碟阵列的stripe 相关性较高。这部份我们底下格式化的时候会举一个例子来说明。</li><li>第7 行里面的internal 指的是这个登录区的位置在档案系统内，而不是外部设备的意思。且占用了4K * 2560 个block，总共约10M 的容量。</li><li>第9 行里面的realtime 区域，里面的extent 容量为4K。不过目前没有使用。</li></ul><h1 id="文件系统的简单操作" tabindex="-1"><a class="header-anchor" href="#文件系统的简单操作"><span>文件系统的简单操作</span></a></h1><h2 id="dumpe2fs-查询ext-家族superblock-信息的指令" tabindex="-1"><a class="header-anchor" href="#dumpe2fs-查询ext-家族superblock-信息的指令"><span>dumpe2fs： 查询Ext 家族superblock 信息的指令</span></a></h2><figure><img src="/assets/images/Linux 磁盘与文件系统管理-dumpe2fs.png" alt="|1050" tabindex="0" loading="lazy"><figcaption>|1050</figcaption></figure><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# dumpe2fs [-bh] 装置档名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出保留为坏轨的部分</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">一般用不到吧！？</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：仅列出superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的资料，不会列出其他的区段内容！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：鸟哥的一块1GB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 档案系统内容</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid    &lt;==这个指令可以叫出目前系统有被格式化的装置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LABEL=&quot;myboot&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;ce4dbf1b-2b3d-4973-8234-73768e8fd659&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LABEL=&quot;myroot&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;21ad8b9a-aaad-443c-b732-4e2522e95e23&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;12y99K-bv2A-y7RY-jhEW-rIWf-PcH5-SaiApN&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;LVM2_member&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;e20d65d9-20d4-472f-9f91-cdcfb30219d6&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;ext4&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==看到ext4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 了！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# dumpe2fs /dev/vda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dumpe2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;            </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 档案系统的名称(不一定会有) </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> availabl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 上一次挂载的目录位置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e20d65d9-20d4-472f-9f91-cdcfb30219d6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> magic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> number:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0xEF53</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 上方的UUID 为Linux 对装置的定义码</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> revision</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #: 1 (dynamic)       # 下方的features 为档案系统的特征资料</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> features:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> has_journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext_attr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resize_inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dir_index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filetype</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 64bit</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> flex_bg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sparse_super</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> large_file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> huge_file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uninit_bg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dir_nlink</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extra_isize</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> signed_directory_hash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> options:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user_xattr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> acl</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 预设在挂载时会主动加上的挂载参数</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 这块档案系统的状态为何，clean 是没问题</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Errors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> behavior:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Continue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 65536</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # inode 的总数</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 262144</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # block 的总数</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Reserved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 13107</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 保留的block 总数</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 249189</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 还有多少的block 可用数量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 65525</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">             # 还有多少的inode 可用数量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">              # 单个block 的容量大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Fragment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 64</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">中间省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).... </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 256</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # inode 的容量大小！已经是256 了喔！</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">中间省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)....</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hash:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> half_md4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Hash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Seed:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3c2568b4-1a7e-44cf-95a2-c8867fb19fbc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> backup:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> features:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (none)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 32M</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">               # Journal 日志式资料的可供纪录总容量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> length:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sequence:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0x00000001</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0-32767</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)                   </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 第一块block group 位置</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x13be,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8181</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Primary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1-1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 主要superblock 的所在喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Reserved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GDT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2-128</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 129</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (+129), Inode bitmap at 145 (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+145</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 161-672</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (+161)                        </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># inode table 的所在喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  28521</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8181</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8181</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 142-144,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 153-160,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4258-32767</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # 底下两行说明剩余的容量有多少</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12-8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">32768-65535</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT]           </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 后续为更多其他的block group 喔！</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">底下省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)....</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 由于资料量非常的庞大，因此鸟哥将一些资讯省略输出了！上表与你的萤幕会有点差异。</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 前半部在秀出supberblock 的内容，包括标头名称(Label)以及inode/block的相关资讯</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 后面则是每个block group 的个别资讯了！您可以看到各区段资料所在的号码！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 也就是说，基本上所有的资料还是与block 的号码有关很重要！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>内容主要可以区分为上半部是superblock 内容， 下半部则是每个block group 的信息，这个 /dev/vda5 规划的 block 为 4K， 第一个 block 号码为 0 号，且 block group 内的所有信息都以block 的号码来表示的。然后在 superblock 中还有谈到目前这个文件系统的可用 block 与 inode 数量.</p><p>至于block group 的内容我们单纯看 Group0</p><ul><li>Group0 所占用的block 号码由0 到32767 号，superblock 则在第0 号的block 区块内！</li><li>文件系统描述说明在第1 号block 中；</li><li>block bitmap 与inode bitmap 则在129 及145 的block 号码上。</li><li>至于inode table 分布于161-672 的block 号码中！</li><li>由于(1)一个inode 占用256 bytes ，(2)总共有672 - 161 + 1(161本身) = 512 个block 花在inode table 上， (3)每个block 的大小为4096 bytes(4K)。由这些数据可以算出inode 的数量共有512 * 4096 / 256 = 8192 个inode 啦！</li><li>这个Group0 目前可用的block 有28521 个，可用的inode 有8181 个；</li><li>剩余的inode 号码为12 号到8192 号。</li></ul><h2 id="磁盘与目录的容量" tabindex="-1"><a class="header-anchor" href="#磁盘与目录的容量"><span>磁盘与目录的容量</span></a></h2><p><a href="#df%E5%88%97%E5%87%BA%E7%B3%BB%E7%BB%9F%E5%90%84%E4%B8%AA%E5%88%86%E5%8C%BA%E7%9A%84%E5%AE%B9%E9%87%8F">df：列出文件系统的整体磁盘使用量</a><br><a href="#du%E7%A3%81%E7%9B%98%E5%AE%B9%E9%87%8F">du：评估文件系统的磁盘使用量,常用在推估目录所占容量</a></p><h3 id="df列出系统各个分区的容量" tabindex="-1"><a class="header-anchor" href="#df列出系统各个分区的容量"><span>df列出系统各个分区的容量</span></a></h3><p>列出系统各个分区的容量</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df [-ahikHTm] [目录或文件名]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出所有的文件系统，包括系统特有的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 等文件系统；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KBytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的容量显示各文件系统；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MBytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的容量显示各文件系统；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以人们较易阅读的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GBytes,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MBytes,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KBytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 等格式自行显示；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-H</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> M=1000K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 取代</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> M=1024K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的进位方式；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-T</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：连同该</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 名称</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (例如 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 也列出；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：不用磁盘容量，而以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的数量来显示</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>范例一：将系统内所有的 filesystem 列出来！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   1K-块</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    已用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    可用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 已用%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10475520</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5361060</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5114460</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   52%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">devtmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                  925324</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  925324</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                     935256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     148</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  935108</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                     935256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    9136</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  926120</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                     935256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  935256</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/fs/cgroup</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                1038336</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  133948</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  904388</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   13%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-home</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  5232640</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   67976</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5164664</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 在 Linux 底下如果 df 没有加任何选项，那么默认会将系统内所有的</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># (不含特殊内存内的文件系统与 swap) 都以 1 Kbytes 的容量来列出来！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 至于那个 /dev/shm 是与内存有关的挂载，先不要理他！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>先来说明一下范例一所输出的结果讯息为：</p><ul><li>Filesystem：代表该文件系统是在哪个 partition ，所以列出装置名称；</li><li>1k-blocks：说明底下的数字单位是 1KB 呦！可利用 -h 或 -m 来改变容量单位；</li><li>Used：顾名思义，就是使用掉的磁盘空间啦！</li><li>Available：也就是剩下的磁盘空间大小；</li><li>Use%：就是磁盘的使用率啦！如果使用率高达 90% 以上时， 最好需要注意一下了，免得容量不足造成系 统问题喔！(例如最容易被灌爆的 /var/spool/mail 这个放置邮件的磁盘)</li><li>Mounted on：就是磁盘挂载的目录所在啦！(挂载点啦！)</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例二：将容量结果以易读的容量格式显示出来</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 容量</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  已用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  可用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 已用%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  5.2G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   52%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 904M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  904M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    914M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  148K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  914M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    914M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  9.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  905M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    914M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  914M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/fs/cgroup</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               1014M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  131M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  884M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   13%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  5.0G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   67M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  5.0G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不同于范例一，这里会以 G/M 等容量格式显示出来，比较容易看啦！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例三：将系统内的所有特殊文件格式及名称都列出来</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df -aT</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df -aT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                类型</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               1K-块</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    已用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    可用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 已用%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rootfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  rootfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          10475520</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5361104</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5114416</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   52%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">proc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    proc</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                   0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /proc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sysfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   sysfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                  0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                devtmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          925324</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  925324</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">securityfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              securityfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/kernel/security</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             935256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     148</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  935108</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">devpts</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  devpts</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/pts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             935256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    9136</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  926120</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   tmpfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             935256</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  935256</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    0%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/fs/cgroup</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cgroup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  cgroup</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/fs/cgroup/systemd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">pstore</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  pstore</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/fs/pstore</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">configfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                configfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">               0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/kernel/config</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">             10475520</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5361104</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5114416</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   52%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemd-1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               autofs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /proc/sys/fs/binfmt_misc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">debugfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 debugfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/kernel/debug</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mqueue</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  mqueue</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">                 0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/mqueue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">hugetlbfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               hugetlbfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/hugepages</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               xfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              1038336</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  133948</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  904388</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   13%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              5232640</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   67976</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5164664</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gvfsd-fuse</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              fuse.gvfsd-fuse</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run/user/1000/gvfs</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 系统里面其实还有很多特殊的文件系统存在的。那些比较特殊的文件系统几乎</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 都是在内存当中，例如 /proc 这个挂载点。因此，这些特殊的文件系统</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 都不会占据磁盘空间！ </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例四：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 底下的可用的磁盘容量以易读的容量格式显示</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df -h /etc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 容量</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  已用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  可用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 已用%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  5.2G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  4.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   52%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这个范例比较有趣一点啦，在 df 后面加上目录或者是文件时， df</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 会自动的分析该目录或文件所在的 partition ，并将该 partition 的容量显示出来，显示的是/的可用容量</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 所以，您就可以知道某个目录底下还有多少容量可以使用了！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例五：将目前各个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 当中可用的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 数量列出</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df -ih</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 已用</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">可用</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">已用</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">I</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    132K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    9.9M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">devtmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 226K</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     410</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    226K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    229K</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    229K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/shm</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    229K</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     564</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    228K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /run</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tmpfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    229K</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    229K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /sys/fs/cgroup</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                1.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     330</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  5.0M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     258</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    5.0M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /home</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这个范例则主要列出可用的 inode 剩余量与总容量。分析一下与范例一的关系，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 你可以清楚的发现到，通常 inode 的数量剩余都比 block 还要多呢</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>由于 df 主要读取的数据几乎都是针对一整个文件系统，因此读取的范围主要是在 Superblock 内的 信息， 所以这个指令显示结果的速度非常的快速！在显示的结果中你需要特别留意的是那个根目录 的剩余容量！ 因为我们所有的数据都是由根目录衍生出来的，因此当根目录的剩余容量剩下 0 时， 那你的 Linux 可能就问题很大了。</p></blockquote><blockquote><p>如果使用 -a 这个参数时，系统会出现 /proc 这个挂载点，但是里面的东西都是0 ，不要紧张！ /proc 的东西都是 Linux 系统所需要加载的系统数据，而且是挂载在『内存当中』的， 所以当然没有占任何的磁盘空间啰！</p></blockquote><blockquote><p>至于那个 /dev/shm/ 目录，其实是利用内存虚拟出来的磁盘空间，通常是总物理内存的一半！ 由于是透过内存仿真出来的磁盘，因此你在这个目录底下建立任何数据文件时，访问速度是非常快速的！(在内存内工作) 不过，也由于他是内存仿真出来的，因此这个文件系统的大小在每部主机上都不一样，而且建立的东西在下次开机时就消失了！ 因为是在内存中</p></blockquote><h3 id="du磁盘容量" tabindex="-1"><a class="header-anchor" href="#du磁盘容量"><span>du磁盘容量</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# du [-ahskm] 文件或目录名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出所有的文件与目录容量，因为默认仅统计目录底下的文件量而已。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以人们较易读的容量格式</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (G/M) 显示；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出总量而已，而不列出每个各别的目录占用容量；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-S</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：不包括子目录下的总计，与</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 有点差别。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> KBytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 列出容量显示；默认</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MBytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 列出容量显示；</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例一：列出目前目录下的所有文件容量</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# du</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.cache/dconf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==每个目录都会列出来</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.cache/abrt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==包括隐藏文件的目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.cache</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.dbus/session-bus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.dbus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.config/abrt</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./.config</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">56</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      .</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">              &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==这个目录</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">所占用的总量</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 直接输入 du 没有加任何选项时，则 du 会分析『目前所在目录』</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 的文件与目录所占用的磁盘空间。但是，实际显示时，仅会显示目录容量(不含文件)，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 因此 . 目录有很多文件没有被列出来，所以全部的目录相加不会等于 . 的容量喔！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 此外，输出的数值数据为 1K 大小的容量单位。</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# ls -l</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">总用量</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:35</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ttttdu</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:47</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ttttdu2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:47</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ttttdu3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# du -h</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">12K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     .</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 由于block的大小为4k, 一个文件最低占用一个block, 也就是4k</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 所以查看当前目录下占用时，示例有三个文件, 虽然都为59byte,</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 但占用位置大小为4k*3=12k</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例二:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 将文件的容量也列出来</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# du -a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./ttttdu</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./ttttdu2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./ttttdu3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">12</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      .</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例三：检查根目录底下每个目录所占用的容量</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# du -sm /*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       /bin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">99</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       /dev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">28</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      /etc</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">35</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      /home</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">中间省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)....</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">du:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 无法访问&quot;/proc/6333/fd/4&quot;:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 没有那个文件或目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">du:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 无法访问&quot;/proc/6333/fdinfo/4&quot;:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 没有那个文件或目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       /proc</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==不会占用硬盘空间！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       /root</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">du:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 无法访问&quot;/run/user/1000/gvfs&quot;:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 权限不够</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">7241</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    /run</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">中间省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)....</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">3395</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    /usr</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==系统初期最大就是他了啦！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1745</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    /var</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这是个很常被使用的功能～利用通配符 * 来代表每个目录，如果想要检查某个目录下，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 哪个次目录占用最大的容量，可以用这个方法找出来。值得注意的是，如果刚刚安装好 Linux 时，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 那么整个系统容量最大的应该是 /usr 。而 /proc 虽然有列出容量，但是那个容量是在内存中，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不占磁盘空间。至于 /proc 里头会列出一堆『No such file or directory』 的错误，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 别担心！因为是内存内的程序，程序执行结束就会消失，因此会有些目录找不到，是正确的！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>与 df 不一样的是，du 直接到文件系统内去搜寻所有的文件数据，会比df耗时！在默认的情况下，容量的输出单位为 KB，可以使用 -m 这个输出MB！使用 -s 只列出目录占用容量！</p><p>至于 -S 这个选项部分，由于 du 默认会将所有文件的大小均列出，因此假设你在 /etc 底下使用 du时， 所有的文件大小，包括 /etc 底下的次目录容量也会被计算一次。然后最终的容量 (/etc) 也会加总一次， 因此很多朋友都会误会 du 分析的结果不太对劲。所以如果想要列出某目录下的全部数据， 可以加上 -S 的选项，减少次目录的加总</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# ll</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">总用量</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 12</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">drwxr-xr-x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 19</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 19:13</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> soon</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:35</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ttttdu</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:47</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ttttdu2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 59</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1月</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  27</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:47</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ttttdu3</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# du</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./soon</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">16</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      .</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study testdu]# du -S</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       ./soon</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">12</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      .</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="软连接硬链接ln" tabindex="-1"><a class="header-anchor" href="#软连接硬链接ln"><span>软连接硬链接ln</span></a></h2><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ln [-sf] 来源文件 目标文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：如果不加任何参数就进行连结，那就是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> link，至于</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 就是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> symbolic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> link</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：如果</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 目标文件</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 存在时，就主动的将目标文件直接移除后再建立！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例一：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/passwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 复制到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 底下，并且观察</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 与</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# cd /tmp</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# cp -a /etc/passwd </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# du -sb ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">df</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6602</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==先注意一下这里的容量是多少！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IUsed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IFree</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IUse%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10485760</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 109748</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10376012</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 利用 du 与 df 来检查一下目前的参数～那个 du -sb 是计算整个 /tmp 底下有多少 bytes 的容量啦！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例二：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/passwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 制作</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hard</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 成为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-hd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件，并观察文件与容量</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# ln passwd passwd-hd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# du -sb ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">df</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6602</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IUsed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IFree</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IUse%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10485760</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 109748</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10376012</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 仔细看，即使多了一个文件在 /tmp 底下，整个 inode 与 block 的容量并没有改变！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# ls -il passwd*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2668897</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2668897</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-hd</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 原来是指向同一个 inode 啊！这是个重点啊！另外，那个第二栏的连结数也会增加！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例三：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/passwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 建立一个符号链接</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# ln -s passwd passwd-so</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# ls -li passwd*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2668897</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2668897</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-hd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2668898</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lrwxrwxrwx.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 23</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 22:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-so</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">passwd</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># passwd-so 指向的 inode number 不同了！这是一个新的文件～这个文件的内容是指向</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># passwd 的。passwd-so 的大小是 6bytes ，因为 『passwd』 这个单字共有六个字符之故</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# du -sb ; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">df</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">6608</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> .</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IUsed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IFree</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> IUse%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10485760</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 109749</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10376011</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 呼呼！整个容量与 inode 使用数都改变啰～确实如此啊！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例四：删除源文件</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ，其他两个文件是否能够开启？</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# rm passwd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# cat passwd-hd</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">正常显示完毕！</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# cat passwd-so</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">cat:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-so:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> No</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> such</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# ll passwd*</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 17</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 00:20</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-hd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lrwxrwxrwx.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 23</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 22:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> passwd-so</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> -&gt; </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">passwd</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 怕了吧！符号链接果然无法开启！另外，如果符号链接的目标文件不存在，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 其实档名的部分就会有特殊的颜色显示喔！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="磁盘的分区、格式化、检验与挂载" tabindex="-1"><a class="header-anchor" href="#磁盘的分区、格式化、检验与挂载"><span>磁盘的分区、格式化、检验与挂载</span></a></h2><p>想要在系统里面新增一颗磁盘时，应该有哪些动作需要做的呢:</p><ol><li>对磁盘进行分区，以建立可用的 partition ；</li><li>对该 partition 进行格式化 (format)，以建立系统可用的 filesystem；</li><li>若想要仔细一点，则可对刚刚建立好的 filesystem 进行检验；</li><li>在 Linux 系统上，需要建立挂载点 (亦即是目录)，并将他挂载上来</li></ol><h3 id="观察磁盘分区状态-lsblk-blkid-parted" tabindex="-1"><a class="header-anchor" href="#观察磁盘分区状态-lsblk-blkid-parted"><span>观察磁盘分区状态-lsblk/blkid/parted</span></a></h3><h4 id="lsblk-列出系统上的所有磁盘列表" tabindex="-1"><a class="header-anchor" href="#lsblk-列出系统上的所有磁盘列表"><span>lsblk 列出系统上的所有磁盘列表</span></a></h4><ul><li>list block device</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# lsblk [-dfimpt] [device]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：仅列出磁盘本身，并不会列出该磁盘的分区数据</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：同时列出该磁盘内的文件系统名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：使用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ASCII</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的线段输出，不要使用复杂的编码</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (再某些环境下很有用)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：同时输出该装置在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 底下的权限数据</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (rwx </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">的数据</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出该装置的完整文件名！而不是仅列出最后的名字而已。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出该磁盘装置的详细数据，包括磁盘队列机制、预读写的数据量大小等</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>范例一</strong>：列出本系统下的所有磁盘与磁盘内的分区信息</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study tmp]# lsblk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            MAJ:MIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   40G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disk</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     # 一整颗磁盘</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    2M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">└─sda3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   30G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  ├─centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 在 sda3 内的其他文件系统</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  ├─centos-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  └─centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    5G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sr0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              11:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  7.1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rom</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /run/media/daihongli/CentOS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x86_64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>从上面的输出我们可以很清楚的看到，目前的系统主要有个 sr0 以及一个 sda 的装置，而 sda 的装置底下又有三个分区， 其中 sda3 甚至还有因为 LVM 产生的文件系统</p><ul><li>NAME：就是设备的文件名，会省略 /dev 等前导目录！</li><li>MAJ:MIN：内核通过这两个代码识别设备，分别是主要：次要设备代码，同种设备MAJ相同，MIN不同</li><li>RM：是否为可卸除装置 (removable device)，如光盘、USB 磁盘等等，1为可卸载</li><li>SIZE：当然就是容量啰！</li><li>RO：是否为只读设备的意思</li><li>TYPE：是磁盘 (disk)、分区槽 (partition) 还是只读存储器 (rom) 等输出</li><li>MOUTPOINT：就是挂载点！</li></ul><p><strong>范例二</strong>：仅列出 /dev/sda 设备内的所有数据的完整文件名</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[daihongli@daihongli-pc ~]$ lsblk -ip /dev/sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    MAJ:MIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MOUNTPOINTS</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  8:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  40G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disk</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/sda1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   2M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/sda3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  30G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/mapper/rl-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  10G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/mapper/rl-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/mapper/rl-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:2    </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   5G  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm  /home</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">`</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-/dev/sda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 完整的文件名，由 / 开始写</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="blkid-列出装置的-uuid-等参数" tabindex="-1"><a class="header-anchor" href="#blkid-列出装置的-uuid-等参数"><span>blkid 列出装置的 UUID 等参数</span></a></h4><blockquote><p>可以使用lsblk -f 来列出文件系统与装置的 UUID 数据，但不如blkid直接。<strong>UUID</strong> 是全局单一标识符 (universally unique identifier)，Linux 会将系统内所有的装置都给予一个独一无二的标识符， 这个标识符就可以拿来作为挂载或者是使用这个装置/文件系统之用了</p></blockquote><p>每一行代表一个文件系统，主要列出装置名称、UUID 名称以及文件系统的类型 (TYPE)</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sr0:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;2015-04-01-00-21-36-00&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LABEL=&quot;CentOS 7 x86_64&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;iso9660&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTTYPE=&quot;dos&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;d3dd9ff1-827d-4ac1-9fe6-f3ab1e7b0f5e&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PARTUUID=&quot;a335616e-8575-4b3a-8cb0-80b0478b3c45&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;Kl0wqu-160U-6TsW-gegq-6Q6h-2qaa-D2IAky&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;LVM2_member&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PARTUUID=&quot;fb4a1bc8-d69e-47df-ab48-0a5f173a040d&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;651095ce-e0d7-4cd9-a92b-0f22cf4cda3b&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-swap:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;706e61e3-bf3e-4527-8c75-38a1d71b6cab&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;swap&quot;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-home:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;3a20c2fb-2603-40da-a193-a740ea225e42&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="parted-列出磁盘的分区表类型与分区信息" tabindex="-1"><a class="header-anchor" href="#parted-列出磁盘的分区表类型与分区信息"><span>parted 列出磁盘的分区表类型与分区信息</span></a></h4><blockquote><p>虽然我们已经知道了系统上面的所有装置，并且透过 blkid 也知道了所有的文件系统！不过，还是不 清楚磁盘的分区类型。 这时我们可以透过简单的 parted 来输出</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# parted device_name print</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例一：列出</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 磁盘的相关数据</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# parted /dev/sda print</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Model:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> VMware,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> VMware</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Virtual</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> S</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (scsi) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 磁盘的模块名称(厂商)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 42.9GB</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 磁盘的总容量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (logical/physical): 512B/512B </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 磁盘的每个逻辑/物理扇区容量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Table:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gpt</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 分区表的格式 (MBR/GPT)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Flags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pmbr_boot</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   End</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    File</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  标志</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 底下才是分区数据</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1049kB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  3146kB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  2097kB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     bios_grub</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      3146kB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  1077MB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  1074MB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  xfs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1077MB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  33.3GB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  32.2GB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     lvm</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# parted /dev/mapper/centos-root print</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Model:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> device-mapper</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (linear) (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/mapper/centos-root:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10.7GB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (logical/physical): 512B/512B</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Table:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> loop</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Flags:</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  End</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    File</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> system</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  标志</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      0.00B</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  10.7GB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  10.7GB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  xfs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="磁盘分区-gdisk-fdisk-parted" tabindex="-1"><a class="header-anchor" href="#磁盘分区-gdisk-fdisk-parted"><span>磁盘分区-gdisk/fdisk/parted</span></a></h3><p>磁盘分区主要有 MBR 以及 GPT 两种格式，分区工具分别为fdisk / gdisk，<strong>不同分区使用的分区工具不要搞错</strong>，也可使用通用工具parted。</p><h4 id="gdisk" tabindex="-1"><a class="header-anchor" href="#gdisk"><span>gdisk</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# gdisk 设备名称</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：由前一小节的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lsblk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 输出，我们知道系统有个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda，请观察该磁盘的分区与相关数据</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# gdisk /dev/sda  &lt;==仔细看，不要加上数字喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">GPT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fdisk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (gdisk) version 0.8.6</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scan:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  MBR:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> protective</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  BSD:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  APM:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  GPT:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> present</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> valid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> with</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> protective</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MBR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPT.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==找到了</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的分区表！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): ?  &lt;==这里可以让你输入指令动作，可以按问号 (?) 来查看可用指令</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       back</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       change</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition&#39;s name</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">d       delete a partition  # 删除一个分区</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">i       show detailed information on a partition</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">l       list known partition types</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">n       add a new partition # 增加一个分区</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">o       create a new empty GUID partition table (GPT)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">p       print the partition table # 印出分区表 (常用)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">q       quit without saving changes # 不储存分区就直接离开 gdisk</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">r       recovery and transformation options (experts only)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">s       sort partitions</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">t       change a partition&#39;s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> code</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">v</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       verify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">w</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       write</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exit</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 储存分区操作后离开 gdisk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">x</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       extra</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> functionality</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (experts </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">only</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">?       print this menu</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): p  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#&lt;== 这里可以输出目前磁盘的状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 磁盘文件名/扇区数与总容量</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">         # 单一扇区大小为 512 bytes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GUID): 3FFD7B58-862B-4A61-A42B-2B31DC5B34C3  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 磁盘的 GPT 标识符</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> holds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 34,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aligned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2048-sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> boundaries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 18862013</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (9.0 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 分区编号 开始扇区号码    结束扇区号码   容量大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sector)    End (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  Size       Code  Name </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 底下为完整的分区信息了！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6143</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EF02</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">       # 第一个分区槽数据</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6144</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103295</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103296</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026047</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   30.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    8E00</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用『 p 』可以列出目前这颗磁盘的分区表信息，</p><p>这个信息的上半部在显示整体磁盘的状态。这个磁盘共有 40GB 左右的容量，共有 83886080 个扇区，每个扇区的容量为512bytes。 要注意的是，现在的分区主要是以扇区为最小的单位</p><p>下半部的分区表信息主要在列出每个分区槽的个别信息项目。每个项目的意义为：</p><ul><li>Number：分区槽编号，1 号指的是 /dev/vda1 这样计算。</li><li>Start (sector)：每一个分区槽的开始扇区号码位置</li><li>End (sector)：每一个分区的结束扇区号码位置，与 start 之间可以算出分区槽的总容量</li><li>Size：就是分区槽的容量了</li><li>Code：在分区槽内的可能的文件系统类型。Linux 为 8300，swap 为 8200。不过这个项目只是一个提示而已，不见得真的代表此分区槽内的文件系统！</li><li>Name：文件系统的名称等等</li></ul><p>从上表我们可以发现几件事情：</p><ul><li>整部磁盘还可以进行额外的分区，因为最大扇区为 83886080，但只使用到 65026047 号而已；</li><li>分区槽的设计中，新分区通常选用上一个分区的结束扇区号码数加 1 作为起始扇区号码！</li></ul><blockquote><p>这个 gdisk 只有 root 才能执行，此外，请注意，使用的『装置文件名』请不要加上数字，因为 partition是针对『整个磁盘装置』而不是某个 partition, 所以执行『 gdisk /dev/sda1 』 就会发生错误, 要使用 gdisk /dev/sda 才对！</p></blockquote><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# gdisk /dev/sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): p</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GUID): 3FFD7B58-862B-4A61-A42B-2B31DC5B34C3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> holds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 34,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aligned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2048-sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> boundaries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 18862013</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (9.0 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sector)    End (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  Size       Code  Name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6143</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EF02</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6144</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103295</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103296</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026047</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   30.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    8E00</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 找出最后一个 sector 的号码是很重要的！  65026047</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): n  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 开始新增的行为</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (4-128, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">default</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): 4  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 预设就是 4 号，所以也能 enter 即可！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (34-83886046, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 65026048</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) or {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+-}size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{KMGTP}</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 65026048</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 也能直接 enter</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (65026048-83886046, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) or {</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+-}size</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{KMGTP}</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> +1G</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 坚决不能能直接 enter会把剩下的全分了</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这个地方可有趣了！我们不需要自己去计算扇区号码，透过 +容量 的这个方式，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 就可以让 gdisk 主动去帮你算出最接近你需要的容量的扇区号码喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Current</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Linux filesystem&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Hex</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> code</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GUID</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (L </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> show</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> codes,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Enter</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8300</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用默认值即可～直接 enter 下去！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这里在让你选择未来这个分区槽预计使用的文件系统！预设都是 Linux 文件系统的 8300 啰！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Changed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Linux filesystem&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): p</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GUID): 3FFD7B58-862B-4A61-A42B-2B31DC5B34C3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> holds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 34,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aligned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2048-sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> boundaries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 16764861</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (8.0 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sector)    End (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  Size       Code  Name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6143</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EF02</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6144</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103295</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103296</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026047</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   30.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    8E00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123199</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  8300</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # 新创建的分区</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重点在『 Last sector 』那一行，那行绝对不要使用默认值！因为默认值会将所有的容量用光！因此它默认选择最大的扇区号码！ 因为我们仅要 1GB 而已，所以你得要加上 +1G 这样即可！不需要计算 sector 的数量，gdisk 会根据你填写的数值， 直接计算出最接近该容量的扇区数！每次新增完毕后，请立即『 p 』查看一下结果</p><p>请继续处理后续的两个分区槽！ 最终出现的画面会有点像底下这样才对！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): p</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GUID): 3FFD7B58-862B-4A61-A42B-2B31DC5B34C3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> holds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 34,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aligned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2048-sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> boundaries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 13643709</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (6.5 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sector)    End (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  Size       Code  Name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6143</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EF02</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6144</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103295</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103296</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026047</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   30.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    8E00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123199</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  8300</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123200</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        69220351</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Microsoft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> basic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        69220352</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        70244351</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   500.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   8200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> swap</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): w</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Final</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> complete.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> About</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> write</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> THIS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> WILL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OVERWRITE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EXISTING</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PARTITIONS!!</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># gdisk 会先警告你可能的问题，我们确定分区是对的，这时才按下 y ！不过怎么还有警告？</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 这是因为这颗磁盘目前正在使用当中，因此系统无法立即加载新的分区表</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Do</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> want</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> proceed?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Y/N): y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GPT) to /dev/sda.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kernel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> still</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> old</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> next</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reboot.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> operation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> has</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> completed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> successfully.</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>基本上，几乎都用默认值，然后透过 +1G, +500M 来建置所需要的另外两个分区槽！文件系统的 ID， Linux 大概都是 8200/8300/8e00 等三种格式， Windows 几乎都用0700，如果忘记这些数字，可以在 gdisk 内按下：『 L 』来显示，确认无误按w写入。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# cat /proc/partitions</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">major</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> minor</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #blocks  name</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  11</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    7413760</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sr0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   41943040</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       2048</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1048576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   31461376</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 253</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10485760</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dm-0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 253</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1048576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dm-1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 253</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    5242880</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dm-2</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 你可以发现，并没有 sda4, sda5, sda6 喔！因为核心还没有更新！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为 Linux 此时还在使用这颗磁盘，为了担心系统出问题，所以分区表并没有被更新！这个时候我们有两个方式可以来处理！ 其中一个是<strong>重新启动</strong>, 另外一个则是通过 <code>partprobe</code> 这个指令来处理即可！</p><h5 id="partprobe-更新-linux-核心的分区表信息" tabindex="-1"><a class="header-anchor" href="#partprobe-更新-linux-核心的分区表信息"><span>partprobe 更新 Linux 核心的分区表信息</span></a></h5><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# partprobe [-s] </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 你可以不要加 -s ！那么屏幕不会出现讯息！</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# partprobe -s  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 不过还是建议加上 -s 比较清晰！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gpt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partitions</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# lsblk /dev/sda  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 实际的磁盘分区状态</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            MAJ:MIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   40G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    2M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   30G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> └─centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    5G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">└─sda6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  500M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# cat /proc/partitions </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 内核的分区纪录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">major</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> minor</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  #blocks  name</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  11</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    7413760</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sr0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   41943040</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">       2048</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1048576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda2</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   31461376</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1048576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1048576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     512000</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sda6</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 253</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   10485760</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dm-0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 253</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1048576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dm-1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 253</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    5242880</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dm-2</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="用-gdisk-删除一个分区槽" tabindex="-1"><a class="header-anchor" href="#用-gdisk-删除一个分区槽"><span>用 gdisk 删除一个分区槽</span></a></h5><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# gdisk /dev/sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): p</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GUID): 3FFD7B58-862B-4A61-A42B-2B31DC5B34C3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> holds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 34,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aligned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2048-sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> boundaries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 13643709</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (6.5 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sector)    End (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  Size       Code  Name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6143</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EF02</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6144</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103295</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103296</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026047</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   30.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    8E00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123199</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  8300</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123200</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        69220351</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Microsoft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> basic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   6</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        69220352</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        70244351</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   500.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   8200</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> swap</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): d</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> number</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (1-6): 6</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): p</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886080</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Logical</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Disk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> identifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GUID): 3FFD7B58-862B-4A61-A42B-2B31DC5B34C3</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> holds</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 128</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> entries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 34,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> usable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 83886046</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Partitions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> aligned</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2048-sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> boundaries</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Total</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> space</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14667709</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sectors</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (7.0 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">GiB</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Number</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Start</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sector)    End (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)  Size       Code  Name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6143</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   2.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     EF02</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            6144</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103295</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         2103296</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026047</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   30.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GiB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    8E00</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        65026048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123199</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  8300</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">   5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        67123200</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">        69220351</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   1024.0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MiB</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0700</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  Microsoft</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> basic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (? </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): w</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Final</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> complete.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> About</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> write</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> THIS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> WILL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OVERWRITE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EXISTING</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">PARTITIONS!!</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Do</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> you</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> want</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> proceed?</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Y/N): y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (GPT) to /dev/sda.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> kernel</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> still</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> old</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> will</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> be</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> next</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reboot.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">The</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> operation</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> has</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> completed</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> successfully.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# partprobe -s</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gpt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partitions</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 无法以读写方式打开</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sr0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (只读文件系统)。/dev/sr0 已按照只读方式打开。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 无法以读写方式打开</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sr0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (只读文件系统)。/dev/sr0 已按照只读方式打开。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Warning:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 无法以读写方式打开</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sr0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (只读文件系统)。/dev/sr0 已按照只读方式打开。</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# lsblk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            MAJ:MIN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  SIZE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sda</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">               8:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   40G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    2M</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   30G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   10G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> └─centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 253:2</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    5G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lvm</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">└─sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            8:5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> part</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sr0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              11:0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  7.1G</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rom</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  /run/media/daihongli/CentOS</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> x86_64</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><span style="background:#ff4d4f;">万分注意！不要去处理一个正在使用中的分区槽！例如，我们的系统现在已经使用了 /dev/vda2 ，那如果你要删除 /dev/vda2 的话， 必须要先将 /dev/vda2 卸除，否则直接删除该分区的话，虽然磁盘还是慧写入正确的分区信息，但是核心会无法更新分区表的信息的！ 另外，文件系统与 Linux 系统的稳定度，恐怕也会变得怪怪的！反正！千万不要处理正在活动文件系统就对了！</span></p><h4 id="fdisk" tabindex="-1"><a class="header-anchor" href="#fdisk"><span>fdisk</span></a></h4><p>disk 跟 gdisk 使用的方式几乎一样, 只是一个使用 ? 作为指令提示数据，一个使用 m 作为提示, fdisk 有时会使用磁柱 (cylinder) 作为分区的最小单位，与 gdisk 默认使用sector, 另外，MBR 分区是有限制的 (Primary, Extended, Logical...)</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fdisk /dev/sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (m </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> help</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): m &lt;== 输入 m 后，就会看到底下这些指令介绍</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Command</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> action</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> toggle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bootable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flag</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> edit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bsd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disklabel</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> toggle</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dos</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> compatibility</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flag</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> delete</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==删除一个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> known</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> types</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">m</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> print</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> this</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> menu</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==新增一个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> empty</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DOS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> print</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> table</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==在屏幕上显示分区表</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">q</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> quit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> without</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> saving</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> changes</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==不储存离开</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fdisk</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 程序</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> create</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> empty</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Sun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disklabel</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> change</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition&#39;s system id</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">u change display/entry units</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">v verify the partition table</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">w write table to disk and exit &lt;==将刚刚的动作写入分区表</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">x extra functionality (experts only)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="磁盘格式化-建置文件系统-mkfs" tabindex="-1"><a class="header-anchor" href="#磁盘格式化-建置文件系统-mkfs"><span>磁盘格式化(建置文件系统)-mkfs</span></a></h3><p>mkfs -make filesystem, 这个指令其实是个综合的指令, 不同文件系统有不同指令，mkfs.xfs，mkfs.exts4.</p><h4 id="xfs-文件系统-mkfs-xfs" tabindex="-1"><a class="header-anchor" href="#xfs-文件系统-mkfs-xfs"><span>XFS 文件系统 mkfs.xfs</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs.xfs [-b bsize] [-d parms] [-i parms] [-l parms] [-L label] [-f] [-r parms] 装置名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">关于单位：底下只要谈到『数值』时，没有加单位则为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 值，可以用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> k,m,g,t,p</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (小写)等来解释</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">比较特殊的是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 这个单位，它指的是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的『个数』喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面接的是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 容量，可由</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 64k，不过最大容量限制为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面接的是重要的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的相关参数值，主要的值有：</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：设定需要几个储存群组的意思(AG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)，通常与 CPU 有关</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	agsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  ：每个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> AG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 设定为多少容量的意思，通常</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> agcount/agsize</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 只选一个设定即可</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        ：指的是『格式化的设备是个文件而不是个设备』的意思！</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">例如虚拟磁盘</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的容量，亦即你可以不将全部的设备容量用完的意思</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	su</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：当有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RAID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 时，那个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stripe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 数值的意思，与底下的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sw</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 搭配使用</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	sw</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：当有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RAID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 时，用于储存数据的磁盘数量</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">须扣除备份盘与备用盘</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	sunit</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：与</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> su</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 相当，不过单位使用的是『几个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">512bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 大小</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">』的意思</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	swidth</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：就是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> su</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">*</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">sw</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的数值，但是以『几个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sector</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">512bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 大小</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">』来设定</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：如果装置内已经有文件系统，则需要使用这个</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 来强制格式化才行！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：与</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 有较相关的设定，主要的设定值有：</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：最小是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 256bytes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 最大是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2k，一般保留</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 256</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 就足够使用了！</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	internal</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">[0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">|</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1]：log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 装置是否为内建？预设为</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 内建，如果要用外部装置，使用底下设定</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	logdev</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">device</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 设备为后面接的那个设备上面的意思，需设定</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> internal=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 才可！</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：指定这块登录区的容量，通常最小得要有</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block，大约</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 以上才行！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面接这个文件系统的标头名称</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的意思！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：指定</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> realtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> section</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的相关设定值，常见的有：</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">	extsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">数值</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> ：就是那个重要的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 数值，一般不须设定，但有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> RAID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 时，</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	最好设定与</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> swidth</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的数值相同较佳！最小为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 最大为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 。</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：将前一小节分区出来的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 格式化为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件系统</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# lsblk -f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            FSTYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     LABEL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                                   MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        d3dd9ff1-827d-4ac1-9fe6-f3ab1e7b0f5e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          LVM2_membe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 Kl0wqu-160U-6TsW-gegq-6Q6h-2qaa-D2IAky</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        651095ce-e0d7-4cd9-a92b-0f22cf4cda3b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       706e61e3-bf3e-4527-8c75-38a1d71b6cab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> └─centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        3a20c2fb-2603-40da-a193-a740ea225e42</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">└─sda5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs.xfs /dev/sda4</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">meta-data</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/dev/sda4</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">              isize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">256</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">4,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> agsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">65536</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> blks</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   attr=2,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> projid32bit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       crc=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        finobt=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=262144,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> imaxpct=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      swidth=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">naming</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   =version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ascii-ci=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ftype=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      =internal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=2560,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lazy-count=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">realtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   extsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rtextents=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# lsblk  -f</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            FSTYPE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     LABEL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                                   MOUNTPOINT</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sda</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        d3dd9ff1-827d-4ac1-9fe6-f3ab1e7b0f5e</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /boot</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          LVM2_membe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                 Kl0wqu-160U-6TsW-gegq-6Q6h-2qaa-D2IAky</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        651095ce-e0d7-4cd9-a92b-0f22cf4cda3b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ├─centos-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       706e61e3-bf3e-4527-8c75-38a1d71b6cab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   [SWAP]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">│</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> └─centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        3a20c2fb-2603-40da-a193-a740ea225e42</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   /home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">├─sda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                        cf49ac5f-f878-4949-9345-f73a8266c19a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">└─sda5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid /dev/sda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;cf49ac5f-f878-4949-9345-f73a8266c19a&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PARTLABEL=&quot;Linux filesystem&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PARID=&quot;fdef7d45-c71a-42b8-bed1-f547633e3831&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>范例二：找出你系统的 CPU 数，并据以设定你的 agcount 数值</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# grep </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;processor&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /proc/cpuinfo</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">processor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">processor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> :</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 所以就是有两颗 CPU 的意思，那就来设定设定我们的 xfs 文件系统格式化参数吧！！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs.xfs -f -d </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /dev/sda4</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">meta-data</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/dev/sda4</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">              isize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">256</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> agsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">131072</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> blks</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   attr=2,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> projid32bit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       crc=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        finobt=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=262144,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> imaxpct=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      swidth=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">naming</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   =version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ascii-ci=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ftype=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      =internal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=2560,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lazy-count=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">realtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   extsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rtextents=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 可以跟前一个范例对照看看，可以发现 agcount 变成 2 了喔！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 此外，因为已经格式化过一次，因此 mkfs.xfs 可能会出现不给你格式化的警告！因此需要使用 -f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="xfs-文件系统-for-raid-效能优化-optional" tabindex="-1"><a class="header-anchor" href="#xfs-文件系统-for-raid-效能优化-optional"><span>XFS 文件系统 for RAID 效能优化 (Optional)</span></a></h4><p>磁盘阵列是多颗磁盘组成一颗大磁盘的意思， 利用同步写入到这些磁盘的技术，不但可以加快读写速度，还可以让某一颗磁盘坏掉时，整个文件系统还是可以持续运作的状态！那就是所谓的容错。</p><p>磁盘阵列 (RAID) 就是透过将文件先细分为数个小型的分区区块 (stripe) 之后，然后将众多的 stripes 分别放到磁盘阵列里面的所有磁盘， 所以一个文件是被同时写入到多个磁盘去，当然效能会好一些。为了文件的保全性，所以在这些磁盘里面， 会保留数个 (与磁盘阵列的规划有关) 备份磁盘 (parity disk)，以及可 能会保留一个以上的备用磁盘 (spare disk)，这些区块基本上会占用掉磁盘阵列的总容量，不过对于数据的保全会比较有保障！</p><p>分区区块 stripe 的数值大多介于 4K 到 1M 之间，这与你的磁盘阵列卡支持的项目有关。stripe与你的文件数据容量以及效能相关性较高。 当你的系统大多是大型文件时，一般建议 stripe 可以设定大一些，这样磁盘阵列读/写的频率会降低，效能会提升。如果是用于系统， 那么小文件比较多的情况下， stripe 建议大约在 64K 左右可能会有较佳的效能。</p><p>优化情境假设：</p><ul><li>我有2个线程的 CPU 数量，所以 agcount 最好指定为 2</li><li>当初设定 RAID 的 stripe 指定为 256K 这么大，因此 su 最好设定为 256k</li><li>设定的磁盘阵列有 8 颗，因为是 RAID5 的设定，所以有一个 parity (备份盘)，因此指定 sw 为 7</li><li>由上述的数据中，我们可以发现数据宽度 (swidth) 应该就是 256K*7 得到 1792K，可以指定 extsize 为1792k</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs.xfs -f -d </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">su</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">256k,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">sw</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">7</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> -r</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extsize=1792k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda4</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">meta-data</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/dev/sda4</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">              isize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">256</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    agcount</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">2,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> agsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">131072</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> blks</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   attr=2,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> projid32bit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       crc=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        finobt=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">data</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=262144,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> imaxpct=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">25</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     swidth=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">448</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">naming</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   =version</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   ascii-ci=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ftype=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      =internal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           bsize=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   blocks=2560,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> version=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                       sectsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">512</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   sunit=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">64</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lazy-count=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">realtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =none</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   extsz=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1835008</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks=0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rtextents=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果分析： sunit 结果是 64 个 block，因为每个 block 为 4K，所以算出来容量就是 256K 也没错！ 那个 swidth 也相同！使用 448 * 4K 得到 1792K！那个 extsz 则是算成 bytes 的单位，换算结果也没错啦！上面是个方式，那如果使用 sunit 与 swidth 直接套用在mkfs.xfs 当中呢？那你得小心了！因为指令中的这两个参数用的是『几个 512bytes 的 sector 数量』的意思！ 是『数量』单位而不是『容量』单位！因此先计算为：</p><ul><li>sunit = 256K/512byte*1024(bytes/K) = 512 个 sector</li><li>swidth = 7 个磁盘 * sunit = 7 * 512 = 3584 个 sector</li></ul><p>所以指令就得要变成如下模样：</p><div class="language-shells line-numbers-mode" data-highlighter="shiki" data-ext="shells" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shells"><span class="line"><span>[root@study ~]# mkfs.xfs -f -d agcount=2,sunit=512,swidth=3584 -r extsize=1792k /dev/sda4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h4 id="ext4-文件系统-mkfs-ext4" tabindex="-1"><a class="header-anchor" href="#ext4-文件系统-mkfs-ext4"><span>EXT4 文件系统 mkfs.ext4</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs.ext4 [-b size] [-L label] 装置名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：设定</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的大小，有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1K,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2K,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的容量，</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面接这个装置的标头名称。</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 格式化为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件系统</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs.ext4 /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mke2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">文件系统标签</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # Filesystem label 显示 Label name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">块大小</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=4096</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (log=2) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 每一个 block 的大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">分块大小</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=4096</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (log=2)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> blocks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Stripe</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> width=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 跟 RAID 相关性较高</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 262144</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 总计 inode/block 的数量13107 blocks (5.00%) reserved for the super user</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">13107</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (5.00%) reserved </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> the super user</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第一个数据块</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Maximum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">268435456</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> groups</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 共有 8 个 block groups 喔！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">32768</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32768</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fragments</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> backups</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stored</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks:</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        32768,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 98304,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 163840,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 229376</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Allocating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> tables:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">正在写入inode表:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Creating</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> journal</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (8192 </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">blocks</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">): 完成</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> accounting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> information:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 完成</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# dumpe2fs -h /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dumpe2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">          &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> availabl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">e&gt;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          c86b2822-a4b6-479b-9930-7165119a90a7</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> magic</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> number:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  0xEF53</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> revision</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> #:    1 (dynamic)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> features:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      has_journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext_attr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resize_inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dir_index</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filetype</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 64bit</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flex_bg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sparse_super</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> large_file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> huge_file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uninit_bg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dir_nlink</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extra_isize</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> flags:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         signed_directory_hash</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> options:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    user_xattr</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> acl</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> state:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">         clean</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Errors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> behavior:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Continue</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> OS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       Linux</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              65536</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              262144</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Reserved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     13107</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              249189</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              65525</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">               4096</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Fragment</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            4096</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    64</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Reserved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GDT</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      127</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         32768</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Fragments</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      32768</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   512</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Flex</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    16</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> created:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       Sun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 28</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 09:44:00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2024</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          n/a</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> write</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">          Sun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 28</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 09:44:01</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2024</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Maximum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      -1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Last</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> checked:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             Sun</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jan</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 28</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 09:44:00</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2024</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Check</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> interval:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">           0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (&lt;none&gt;)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Lifetime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> writes:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">          33</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Reserved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uid:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (user </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Reserved</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gid:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (group </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">First</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">              11</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> size:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">               256</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Required</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extra</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> isize:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">     28</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Desired</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extra</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> isize:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">      28</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            8</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Default</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> hash:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   half_md4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Hash</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Seed:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      3d2850c0-8600-4164-a5d4-6345dfd78a79</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> backup:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">           inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> features:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         (none)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">日志大小:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">             32M</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> length:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">           8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sequence:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         0x00000001</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Journal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">            0</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">0-32767</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x19b7,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8181</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  主</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1-1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  保留的GDT块位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2-128</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 129</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (+129), Inode bitmap at 145 (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">+145</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 161-672</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (+161)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  28521</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8181</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8181个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 142-144,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 153-160,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4258-32767</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12-8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">32768-65535</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0xfedb,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  备份</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 32768,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 32769-32769</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  保留的GDT块位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 32770-32896</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 130</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 130), Inode bitmap at 146 (bg #0 + 146)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 673-1184</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 673)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  32639</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 32897-65535</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8193-16384</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">65536-98303</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT, BLOCK_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x4b16,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 131</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 131), Inode bitmap at 147 (bg #0 + 147)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1185-1696</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 1185)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  32768</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 65536-98303</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 16385-24576</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">98304-131071</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0xa615,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  备份</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 98304,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 98305-98305</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  保留的GDT块位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 98306-98432</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 132</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 132), Inode bitmap at 148 (bg #0 + 148)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1697-2208</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 1697)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  32639</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 98433-131071</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 24577-32768</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">131072-163839</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0xb596,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 133</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 133), Inode bitmap at 149 (bg #0 + 149)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2209-2720</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 2209)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  24576</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 139264-163839</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 32769-40960</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">163840-196607</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x8758,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  备份</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 163840,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 163841-163841</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  保留的GDT块位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 163842-163968</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 134</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 134), Inode bitmap at 150 (bg #0 + 150)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2721-3232</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 2721)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  32639</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 163969-196607</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 40961-49152</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 6:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">196608-229375</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT, BLOCK_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x3295,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 135</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 135), Inode bitmap at 151 (bg #0 + 151)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3233-3744</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 3233)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  32768</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 196608-229375</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 49153-57344</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 7:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (Blocks </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">229376-262143</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) [INODE_UNINIT]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Checksum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 0x1789,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unused</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  备份</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 229376,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> descriptors</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 229377-229377</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  保留的GDT块位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 229378-229504</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> at</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 136</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 136), Inode bitmap at 152 (bg #0 + 152)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Inode表位于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3745-4256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (bg </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#0 + 3745)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  32639</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8192</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> free</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directories,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8192个未使用的inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用块数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 229505-262143</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  可用inode数:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 57345-65536</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="其他文件系统-mkfs" tabindex="-1"><a class="header-anchor" href="#其他文件系统-mkfs"><span>其他文件系统 mkfs</span></a></h4><p>mkfs 其实是个综合指令而已，当我们使用 mkfs -t xfs 时，它就会跑去找 mkfs.xfs 相关的参数给我们使用！ 如果想要知道系统还支持哪种文件系统的格式化功能，直接按 [tabl] 就很清楚了！</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkfs[tab][tab]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.btrfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.cramfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.ext2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.ext3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.ext4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkfs.fat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.minix</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.msdos</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.vfat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkfs.xfs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="文件系统检验" tabindex="-1"><a class="header-anchor" href="#文件系统检验"><span>文件系统检验</span></a></h3><h4 id="xfs-repair-处理-xfs-文件系统" tabindex="-1"><a class="header-anchor" href="#xfs-repair-处理-xfs-文件系统"><span>xfs_repair 处理 XFS 文件系统</span></a></h4><p>当有 xfs 文件系统错乱才需要使用这个指令！所以，这个指令最好是不要用到啦！但有问题发生时，这个指令却又很重要</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_repair [-fnd] 装置名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面的装置其实是个文件而不是实体设备</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：单纯检查并不修改文件系统的任何数据</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (检查而已)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：通常用在单人维护模式底下，针对根目录</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (/) 进行检查与修复的动作！很危险！不要随便使用</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：检查一下刚刚建立的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件系统</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_repair /dev/sda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> find</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> verify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> using</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> internal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zero</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> freespace</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> maps...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> chunk</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> each</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> AG...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> scan</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clear</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> agi</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unlinked</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lists...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> process</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> known</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> perform</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> discovery...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> agno</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> agno</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> process</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> newly</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> discovered</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> check</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> duplicate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> setting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> up</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> duplicate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> extent</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> check</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> for</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> claiming</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> duplicate</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> agno</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> agno</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rebuild</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> AG</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> headers</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> trees...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reset</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> check</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connectivity...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> resetting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> contents</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> of</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> realtime</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bitmap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> summary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> traversing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> traversal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> finished</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> moving</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disconnected</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> to</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lost+found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ...</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Phase</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> verify</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> correct</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> link</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> counts...</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">done</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 共有 7 个重要的检查流程！详细的流程介绍可以 man xfs_repair 即可！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：检查一下系统原本就有的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/centos/home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件系统</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_repair /dev/centos/home</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xfs_repair:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/centos/home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> contains</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">xfs_repair:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/centos/home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> contains</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> writable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">fatal</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> error</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> couldn&#39;t initialize XFS library</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>xfs_repair 可以检查/修复文件系统，不过，因为修复文件系统是个很庞大的任务！因此，修复时该文件系统不能被挂载！ 所以，检查与修复 /dev/vda4 没啥问题，但是修复 /dev/centos/home 这个已经挂载的文件系统时，就出现上述的问题了！ 没关系，若可以卸除，卸除后再处理即可。</p><p>Linux 系统有个装置无法被卸除，那就是根目录啊！如果你的根目录有问题怎办？这时得要进入单人维护或救援模式，然后透过 -d 这个选项来处理！ 加入 -d 这个选项后，系统会强制检验该装置，检验完毕后就会自动重新启动啰！不过，鸟哥完全不打算要进行这个指令的实做... 永远都不希望实做这东西...</p><h4 id="fsck-ext4-处理-ext4-文件系统" tabindex="-1"><a class="header-anchor" href="#fsck-ext4-处理-ext4-文件系统"><span>fsck.ext4 处理 EXT4 文件系统</span></a></h4><p>fsck 是个综合指令，如果是针对 ext4 的话，建议直接使用 fsck.ext4 来检测比较妥当！那 fsck.ext4的选项有底下几个常见的项目：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 [-pf] [-b superblock] 装置名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：当文件系统在修复时，若有需要回复</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的动作时，自动回复</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 来继续进行修复动作。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：强制检查！一般来说，如果</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fsck</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 没有发现任何</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unclean</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的标识，不会主动进入详细检查的，如果您想要强制</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fsck</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 进入详细检查，就得加上</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 标识</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-D</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：针对文件系统下的目录进行优化配置。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面接</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的位置！一般来说这个选项用不到。但是如果你的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 因故损毁时，透过这个参数即可利用文件系统内备份的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 来尝试救援。一般来说，superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 备份在：1K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 放在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 8193,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 放在</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 16384,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4K</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 放在</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32768</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：找出刚刚建置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的另一块</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock，并据以检测系统</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# dumpe2fs -h /dev/sda5 |</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;Blocks per group&#39;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dumpe2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> per</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">         32768</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 看起来每个 block 群组会有 32768 个 block，因此第二个 superblock 应该就在 32768 上！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 因为 block 号码为 0 号开始编的！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 -b 32768 /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cleanly</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unmounted,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 强制检查.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第一步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查inode,块,和大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第二步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查目录结构</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第3步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查目录连接性</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reference</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> counts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第5步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查簇概要信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda5:</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *****</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件系统已修改</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *****</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 文件系统被改过，所以这里会有警告！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 11/65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0.0% </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non-contiguous</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), 12955/262144 blocks</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 -b 32768 /dev/vda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> was</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cleanly</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> unmounted,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> check</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> forced.</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sizes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Deleted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inode</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1577</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> has</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zero</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dtime.</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Fix</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;y&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> yes</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 2:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> structure</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> directory</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connectivity</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reference</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> counts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> group</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> summary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> information</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5:</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *****</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FILE</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SYSTEM</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> WAS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> MODIFIED</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> *****</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 文件系统被改过，所以这里会有警告！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 11/65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0.0% </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non-contiguous</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), 12955/262144 blocks</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 好巧合！鸟哥使用这个方式来检验系统，恰好遇到文件系统出问题！于是可以有比较多的解释方向！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 当文件系统出问题，它就会要你选择是否修复～如果修复如上所示，按下 y 即可！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 最终系统会告诉你，文件系统已经被更改过，要注意该项目的意思！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：已预设设定强制检查一次</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 11/65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> files,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12955/262144</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 -f /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第一步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查inode,块,和大小</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第二步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查目录结构</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第3步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查目录连接性</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> reference</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> counts</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">第5步:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 检查簇概要信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 11/65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> files</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (0.0% </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">non-contiguous</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), 12955/262144 blocks</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 11/65536</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> files,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 12955/262144</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 文件系统状态正常，它并不会进入强制检查！会告诉你文件系统没问题 (clean)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# fsck.ext4 -f /dev/sda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e2fsck</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Pass</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Checking</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> inodes,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> blocks,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sizes</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">底下省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><span style="background:rgba(255, 183, 139, 0.55);"><!----></span></p><h3 id="文件系统挂载与卸除" tabindex="-1"><a class="header-anchor" href="#文件系统挂载与卸除"><span>文件系统挂载与卸除</span></a></h3><p>挂载点是目录，而且目录是进入文件系统（磁盘分区槽）的入口，挂在前要确认：</p><ul><li>单一文件系统不应该被重复挂载在不同的挂载点(目录)中；</li><li><strong>单一目录不应该重复挂载多个文件系统；</strong></li><li><strong>要作为挂载点的目录，理论上应该都是空目录才是。</strong></li></ul><p>尤其是上述的后两点！如果你要用来挂载的目录里面并不是空的，那么挂载了文件系统之后，原目录下的东西就会暂时的消失。举个例子来说，假设你的 /home 原本与根目录 (/) 在同一个文件系统中，底下原本就有 /home/test 与 /home/vbird 两个目录。然后你想要加入新的磁盘，并且直接挂载 /home底下，那么当你挂载上新的分区槽时，则 /home 目录显示的是新分区槽内的资料，至于原先的 test 与vbird 这两个目录就会暂时的被隐藏掉了！注意喔！并不是被覆盖掉， 而是暂时的隐藏了起来，等到新分区槽被卸除之后，则 /home 原本的内容就会再次的跑出来</p><h4 id="mount挂载命令" tabindex="-1"><a class="header-anchor" href="#mount挂载命令"><span>mount挂载命令</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount -a</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount [-l]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount [-t 文件系统] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LABEL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 挂载点</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount [-t 文件系统] </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> 挂载点</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 鸟哥近期建议用这种方式喔！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount [-t 文件系统] 装置文件名 挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：依照配置文件</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/fstab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的数据将所有未挂载的磁盘都挂载上来</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：单纯的输入</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 会显示目前挂载的信息。加上</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 可增列</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 名称！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：可以加上文件系统种类来指定欲挂载的类型。常见的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 支持类型有：xfs,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext3,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext4,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	reiserfs,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vfat,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iso9660</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">光盘格式</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nfs,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cifs,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> smbfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (后三种为网络文件系统类型)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：在默认的情况下，系统会将实际挂载的情况实时写入</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/mtab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 中，以利其他程序的运作。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	但在某些情况下(例如单人维护模式</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)为了避免问题会刻意不写入。此时就得要使用 -n 选项。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-o</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：后面可以接一些挂载时额外加上的参数！比方说账号、密码、读写权限等：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	async,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> sync:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 此文件系统是否使用同步写入</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (sync) 或异步 (</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">async</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) 的</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	内存机制，请参考文件系统运作方式。预设为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> async。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	atime,noatime:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 是否修订文件的读取时间</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">atime</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">。为了效能，某些时刻可使用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> noatime</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	ro,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rw:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载文件系统成为只读</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ro</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">或可擦写</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rw</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	auto,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> noauto:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 允许此</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 被以</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -a</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 自动挂载</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">auto</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	dev,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nodev:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 是否允许此</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 上，可建立装置文件？</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 为可允许</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	suid,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nosuid:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 是否允许此</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 含有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> suid/sgid</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的文件格式？</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">	exec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> noexec:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 是否允许此</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 上拥有可执行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> binary</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件？</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	user,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nouser:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 是否允许此</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 让任何使用者执行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ？一般来说，</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 仅有</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 可以进行，但下达</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 参数，则可让</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		一般</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> user</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 也能够对此</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> partition</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 进行</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">defaults:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 默认值为：rw,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> suid,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dev,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exec,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> auto,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nouser,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> async</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">remount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 重新挂载，这在系统出错，或重新更新参数时，很有用！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你不需要加上 -t 这个选项，系统会自动的分析最恰当的文件系统来尝试挂载你需要的装置！ 这也是使用 blkid 就能够显示正确的文件系统的缘故！由于文件系统几乎都有 superblock ，Linux 可以透过分析superblock 搭配 Linux 自己的驱动程序去测试挂载， 如果成功的套和了，就立刻自动的使用该类型的文件系统挂载起来！那么系统有没有指定哪些类型的 filesystem 才需要进行上述的挂载测试呢？主要是参考底下这两个文件：</p><ul><li>/etc/filesystems：系统指定的测试挂载文件系统类型的优先级；</li><li>/proc/filesystems：Linux 系统已经加载的文件系统类型</li></ul><p>Linux 支持的文件系统之驱动程序都写在如下的目录中：</p><ul><li>/lib/modules/$(uname -r)/kernel/fs/</li></ul><h4 id="挂载xfs-ext4-vfat-等文件系统" tabindex="-1"><a class="header-anchor" href="#挂载xfs-ext4-vfat-等文件系统"><span>挂载xfs/ext4/vfat 等文件系统</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：找出</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 后，用该</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 来挂载文件系统到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 内</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid /dev/vda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda4:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;e0a6af55-26e7-4cb7-a515-826a8bd29e90&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;xfs&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;e0a6af55-26e7-4cb7-a515-826a8bd29e90&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/xfs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> point</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> does</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> not</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> exist</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 非正规目录！所以手动建立它！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkdir -p /data/xfs</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;e0a6af55-26e7-4cb7-a515-826a8bd29e90&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/xfs</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df /data/xfs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1K-blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Available</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1038336</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 32864</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1005472</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 4%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/xfs</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 顺利挂载，且容量约为 1G 左右没问题！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：使用相同的方式，将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 挂载于</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid /dev/vda5</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;899b755b-1da4-4d1d-9b1c-f762adb798e1&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;ext4&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkdir /data/ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;899b755b-1da4-4d1d-9b1c-f762adb798e1&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df /data/ext4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1K-blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Available</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 999320</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2564</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 927944</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/ext4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="挂载-cd-或-dvd-光盘" tabindex="-1"><a class="header-anchor" href="#挂载-cd-或-dvd-光盘"><span>挂载 CD 或 DVD 光盘</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：将你用来安装</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Linux</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> CentOS</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 原版光盘拿出来挂载到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/cdrom！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">前面省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).....</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sr0:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;2015-04-01-00-21-36-00&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LABEL=&quot;CentOS 7 x86_64&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;iso9660&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> PTTYPE=&quot;dos&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkdir /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount /dev/sr0 /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/sr0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> write-protected,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mounting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read-only</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1K-blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Available</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sr0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7413478</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7413478</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 100%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 怎么会使用掉 100% 呢？是啊！因为是 DVD 啊！所以无法再写入了啊！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="挂载-vfat-中文u盘" tabindex="-1"><a class="header-anchor" href="#挂载-vfat-中文u盘"><span>挂载 vfat 中文U盘</span></a></h4><p>这个U盘不能够是 NTFS 的文件系统</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：找出你的随身碟装置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID，并挂载到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/usb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 目录中</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# blkid</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda1:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID=&quot;35BC-6D6B&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> TYPE=&quot;vfat&quot;[root@study</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~]#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/usb</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount -o </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">codepage</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">950,</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iocharset</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">utf8</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;35BC-6D6B&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/usb</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># mount -o codepage=950,iocharset=big5 UUID=&quot;35BC-6D6B&quot; /data/usb</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df /data/usb</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1K-blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Available</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092344</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2092340</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/usb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果带有中文文件名的数据，那么可以在挂载时指定一下挂载文件系统所使用的语系数据。 在 manmount 找到 vfat 文件格式当中可以使用 codepage 来处理！中文语系的代码为 950 喔！另外，如果想要指定中文是万国码还是大五码， 就得要使用 iocharset 为 utf8 还是 big5 两者择一了！因为鸟哥的随身碟使用 utf8 编码，因此将上述的 big5 前面加上 # 符号</p><p>万一你使用的 USB 磁盘被格式化为 NTFS 时，那可能就得要动点手脚，因为预设的 CentOS 7 并没有支持 NTFS 文件系统格式！所以你得要安装 NTFS 文件系统的驱动程序后，才有办法处理的</p><h4 id="mount-o-remount重新挂载根目录与挂载不特定目录" tabindex="-1"><a class="header-anchor" href="#mount-o-remount重新挂载根目录与挂载不特定目录"><span>mount -o remount重新挂载根目录与挂载不特定目录</span></a></h4><p>根目录无法被卸载，但如果要<strong>改变挂载参数</strong>，或者根目录出现<strong>只读状态</strong>时，可以重新启动（reboot), 或者下面这样做：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 重新挂载，并加入参数为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rw</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 与</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> auto</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount -o remount,rw,auto /</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>重点是那个『 -o remount,xx 』的选项与参数！请注意，要重新挂载 (remount) 时， 这是个非常重要的机制！尤其是当你进入单人维护模式时，你的根目录常会被系统挂载为只读，这个时候这个指令就太重要了！</p><p>另外，我们也可以利用 mount 来<strong>将某个目录挂载到另外一个目录去</strong>, 这并不是挂载文件系统，而是额外挂载某个目录的方法！ 虽然底下的方法也可以使用 symbolic link 来连结，不过在某些不支持符号链接的程序运作中，还是得要透过这样的方法才行</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 这个目录暂时挂载到</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/var</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 底下：</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkdir /data/var</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount --bind /var /data/var</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ls -lid /var /data/var</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">16777346</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 23:43</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/var</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">16777346</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> drwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 22</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4096</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 15</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 23:43</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 内容完全一模一样啊！因为挂载目录的缘故！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> var</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/var</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (rw,relatime,seclabel,attr2,inode64,noquota)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>看起来，其实两者连结到同一个 inode, 透过这个 mount --bind 的功能， 您可以将某个目录挂载到其他目录去喔！而并不是整块 filesystem 的啦！所以从此进入 /data/var 就是进入/var 的意思.</p><h4 id="umount-将装置文件卸除" tabindex="-1"><a class="header-anchor" href="#umount-将装置文件卸除"><span>umount (将装置文件卸除)</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount [-fn] 装置文件名或挂载点</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：强制卸除！可用在类似网络文件系统</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (NFS) 无法读取到的情况下；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：立刻卸除文件系统，比</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 还强！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：不更新</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/mtab</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 情况下卸除</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>范例：将本章之前自行挂载的文件系统全部卸除：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">前面省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).....</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (rw,relatime,seclabel,attr2,inode64,logbsize=256k,sunit=512,..)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/vda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/ext4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ext4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (rw,relatime,seclabel,data=ordered)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sr0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/cdrom</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> iso9660</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (ro,relatime)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/sda1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/usb</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vfat</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (rw,relatime,fmask=0022,dmask=0022,codepage=950,iocharset=...)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/var</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> type</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (rw,relatime,seclabel,attr2,inode64,noquota)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 先找一下已经挂载的文件系统，如上所示，特殊字体即为刚刚挂载的装置啰！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 基本上，卸除后面接装置或挂载点都可以！不过最后一个 centos-root 由于有其他挂载，</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 因此，该项目一定要使用挂载点来卸除才行！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /dev/vda4 &lt;==用装置文件名来卸除</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /data/ext4 &lt;==用挂载点来卸除</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /data/cdrom &lt;==因为挂载点比较好记忆！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /data/usb</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /data/var &lt;==一定要用挂载点！因为装置有被其他方式挂载</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于通通卸除了，此时你才可以退出光盘片、软盘片、USB 随身碟等设备喔！如果你遇到这样的情况：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount /dev/sr0 /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# cd /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study cdrom]# umount /data/cdrom</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">umount:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/cdrom:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> target</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> busy.</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">In</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> some</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cases</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> useful</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> info</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> about</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> processes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> that</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> use</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">the</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> device</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> found</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> by</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> lsof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">or</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fuser</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study cdrom]# cd /</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study /]# umount /data/cdrom</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>由于你目前正在 /data/cdrom/ 的目录内，也就是说其实你<strong>正在使用该文件系统</strong>, 所以自无法卸除！离开该文件系统的挂载点即可。以上述的案例来说， 你可以使用『 cd / 』回到根目录，就能够卸除 /data/cdrom</p><h3 id="磁盘-文件系统参数自定义" tabindex="-1"><a class="header-anchor" href="#磁盘-文件系统参数自定义"><span>磁盘/文件系统参数自定义</span></a></h3><h4 id="mknod" tabindex="-1"><a class="header-anchor" href="#mknod"><span>mknod</span></a></h4><p>Linux下一切接文件，设备也是文件，是通过文件的 major（主要设备代码） 与 minor（次要设备代码） 数值来区分具体设备类型的。Linux 核心 2.6 版以后，硬件文件名已经都可以被系统自动的实时产生了，我们根本不需要手动建立装置文件。 不过某些情况底下我们可能还是得要手动处理装置文件的，例如在某些服务被chroot到特定目录下时， 就需要这样做了。</p><table><thead><tr><th>磁盘文件名</th><th>Major</th><th>Minor</th></tr></thead><tbody><tr><td>/dev/sda</td><td>8</td><td>0-15</td></tr><tr><td>/dev/sdb</td><td>8</td><td>16-31</td></tr><tr><td>/dev/loop0</td><td>7</td><td>0</td></tr><tr><td>/dev/loop1</td><td>7</td><td>1</td></tr></tbody></table><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mknod 设备文件名 [bcp] [Major] [Minor]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">装置种类：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">b</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：设定设备名称成为一个外接存设备文件，例如磁盘等；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">c</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：设定设备名称成为一个外接输入设备文件，例如鼠标/键盘等；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">p</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：设定设备名称成为一个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FIFO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Major</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：主设备代码；</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Minor</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：次设备代码；</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：由上述的介绍我们知道</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 装置代码</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 252,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 10，请建立并查阅此装置</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mknod /dev/vda10 b 252 10</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ll /dev/vda10</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">brw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 252,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 23:40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda10</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 上面那个 252 与 10 是有意义的，不要随意设定啊！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：建立一个</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> FIFO</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 文件，档名为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/testpipe</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mknod /tmp/testpipe p</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ll /tmp/testpipe</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">prw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jun</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 24</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 23:44</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/testpipe</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 注意啊！这个文件可不是一般文件，不可以随便就放在这里！</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试完毕之后请删除这个文件吧！看一下这个文件的类型！是 p 喔！^_^</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# rm /dev/vda10 /tmp/testpipe</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remove</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> block</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> special</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/dev/vda10&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> y</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">rm:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> remove</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> fifo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;/tmp/testpipe&#39;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> y</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="xfs-admin-修改-xfs-文件系统的-uuid-与-label-name" tabindex="-1"><a class="header-anchor" href="#xfs-admin-修改-xfs-文件系统的-uuid-与-label-name"><span>xfs_admin 修改 XFS 文件系统的 UUID 与 Label name</span></a></h4><p>如果你当初格式化的时候忘记加上标头名称，后来想要再次加入时，不需要重复格式化！直接使用这个 xfs_admin 即可</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">root@study</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ~]#</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> xfs_admin</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-lu] [-L label] [-U uuid] 装置文件名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出这个装置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-u</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：列出这个装置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：设定这个装置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name-U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：设定这个装置的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 喔！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：设定</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda4</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 为</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vbird_xfs，并测试挂载</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_admin -L vbird_xfs /dev/vda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SBs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;vbird_xfs&quot;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 产生新的 LABEL 名称啰！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_admin -l /dev/vda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;vbird_xfs&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LABEL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">vbird_xfs</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/xfs/</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：利用</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> uuidgen</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 产生新</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 来设定</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda4，并测试挂载</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /dev/vda4 </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用前，请先卸除！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# uuidgen</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">e0fa7252-b374-4a06-987a-3cb14f415488</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> # 很有趣的指令！可以产生新的 UUID 喔！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_admin -u /dev/vda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e0a6af55-26e7-4cb7-a515-826a8bd29e90</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# xfs_admin -U e0fa7252-b374-4a06-987a-3cb14f415488 /dev/vda4</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Clearing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> log</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> setting</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">writing</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> all</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> SBs</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">new</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> e0fa7252-b374-4a06-987a-3cb14f415488</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">e0fa7252-b374-4a06-987a-3cb14f415488</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/xfs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="tune2fs-修改-ext4-的-label-name-与-uuid" tabindex="-1"><a class="header-anchor" href="#tune2fs-修改-ext4-的-label-name-与-uuid"><span>tune2fs 修改 ext4 的 label name 与 UUID</span></a></h4><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# tune2fs [-l] [-L Label] [-U uuid] 装置文件名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">选项与参数：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-l</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：类似</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> dumpe2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -h</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的功能～将</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> superblock</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 内的数据读出来～</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：修改</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> LABEL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-U</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ：修改</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> UUID</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 啰！</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">范例：列出</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/vda5</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> label</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 之后，将它改成</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vbird_ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# dumpe2fs -h /dev/vda5 | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">dumpe2fs</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1.42.9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (28-Dec-2013)Filesystem volume name: &lt;none&gt; </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 果然是没有设定的！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# tune2fs -L vbird_ext4 /dev/vda5</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# dumpe2fs -h /dev/vda5 | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> volume</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> name:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> vbird_ext4</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">LABEL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">vbird_ext4</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /data/ext4</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="设定开机挂载" tabindex="-1"><a class="header-anchor" href="#设定开机挂载"><span>设定开机挂载</span></a></h3><h4 id="开机挂载-etc-fstab-及-etc-mtab" tabindex="-1"><a class="header-anchor" href="#开机挂载-etc-fstab-及-etc-mtab"><span>开机挂载 /etc/fstab 及 /etc/mtab</span></a></h4><p>系统挂载的一些限制：</p><ul><li>根目录 / 是必须挂载的﹐而且一定要先于其它挂载点 (mount point) 被挂载进来。</li><li>其它 mount point 必须为已建立的目录﹐可任意指定﹐但一定要遵守必须的系统目录架构原则 (FHS)</li><li>所有 mount point 在同一时间之内﹐只能挂载一次。</li><li>所有硬盘分区 （partition） 在同一时间之内﹐只能挂载一次。</li><li>如若进行卸除﹐您必须先将工作目录移到 mount point(及其子目录) 之外。</li></ul><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study /]# cat /etc/fstab</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># /etc/fstab</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Created by anaconda on Sat Jan 20 23:03:48 2024</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Accessible filesystems, by reference, are maintained under &#39;/dev/disk&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Device                                  Mount      point filesystem parameters dump fsck</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   /</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                  xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       defaults</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">UUID</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">d3dd9ff1-827d-4ac1-9fe6-f3ab1e7b0f5e</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> /boot</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       defaults</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                   /home</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              xfs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">       defaults</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/mapper/centos-swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                    swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              swap</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      defaults</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>/etc/fstab (filesystem table) 就是将我们利用 mount 指令进行挂载时， 将所有的选项与参数写入到这个文件中。 /etc/fstab 还加入了 dump 这个备份用指令的支持！ 与开机时是否进行文件系统检验 fsck 等指令有关。 这个文件的内容共有六个字段</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[装置/UUID 等] [挂载点] [文件系统] [文件系统参数] [dump] [fsck]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>o 第一栏：磁盘设备文件名/UUID/LABEL name：<br> 这个字段可以填写的数据主要有三个项目：</p><ul><li>文件系统或磁盘的设备文件名，如 /dev/vda2 等</li><li>文件系统的 UUID 名称，如 UUID=xxx</li><li>文件系统的 LABEL 名称，例如 LABEL=xxx</li></ul><p>o 第二栏：挂载点 (mount point)：：<br> 就是挂载点，一定是目录</p><p>o 第三栏：磁盘分区的文件系统：<br> 在手动挂载时可以让系统自动测试挂载，但在这个文件当中我们必须要手动写入文件系统才行！包括 xfs, ext4, vfat, reiserfs, nfs 等等。</p><p>o 第四栏：文件系统参数：<br> 前面示例中『codepage=950,iocharset=utf8』这些特殊的参数就是写入在这个字段</p><table><thead><tr><th>参数</th><th>内容意义</th></tr></thead><tbody><tr><td>async/sync <br>异步/同步 设定磁盘是否以异步方式运作！预设为 async(效能较佳)</td><td></td></tr><tr><td></td><td></td></tr><tr><td>auto/noauto <br>自动/非自动</td><td>当下达 mount -a 时，此文件系统是否会被主动测试挂载。预设为 auto。</td></tr><tr><td>rw/ro <br>可擦写/只读</td><td>让该分区槽以可擦写或者是只读的型态挂载上来，如果你想要分享的数据是不给用 <br>户随意变更的， 这里也能够设定为只读。则不论在此文件系统的文件是否设定 w <br>权限，都无法写入喔！</td></tr><tr><td>exec/noexec <br>可执行/不可执行</td><td>限制在此文件系统内是否可以进行『执行』的工作？如果是纯粹用来储存数据的目 <br>录， 那么可以设定为 noexec 会比较安全。不过，这个参数也不能随便使用，因为 <br>你不知道该目录下是否默认会有执行档。 <br>举例来说，如果你将 noexec 设定在 /var ，当某些软件将一些执行文件放置于 /var <br>下时，那就会产生很大的问题喔！ 因此，建议这个 noexec 最多仅设定于你自定义 <br>或分享的一般数据目录。</td></tr><tr><td>user/nouser <br>允许/不允许使用者挂载</td><td>是否允许用户使用 mount 指令来挂载呢？一般而言，我们当然不希望一般身份的 <br>user 能使用 mount 啰，因为太不安全了，因此这里应该要设定为 nouser 啰！</td></tr><tr><td>suid/nosuid <br>具有/不具有 suid 权限</td><td>该文件系统是否允许 SUID 的存在？如果不是执行文件放置目录，也可以设定为 <br>nosuid 来取消这个功能！</td></tr><tr><td>defaults</td><td>同时具有 rw, suid, dev, exec, auto, nouser, async 等参数。 基本上，预设情况使用 <br>defaults 设定即可！</td></tr></tbody></table><p>o 第五栏：能否被 dump 备份指令作用：<br> dump 是一个用来做为备份的指令，不过现在有太多的备份方案了，所以这个项目直接输入 0</p><p>o 第六栏：是否以 fsck 检验扇区：<br> 早期开机的流程中，会有一段时间去检验本机的文件系统，看看文件系统是否完整 (clean)。 不过这个方式使用的主要是透过 fsck 去做的，我们现在用的 xfs 文件系统就没有办法适用，因为 xfs会自己进行检验，不需要额外进行这个动作！所以直接填 0 就好了。</p><p>例题：<br> 假设我们要将 /dev/vda4 每次开机都自动挂载到 /data/xfs ，该如何进行？</p><div class="language-shll line-numbers-mode" data-highlighter="shiki" data-ext="shll" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shll"><span class="line"><span>[root@study ~]# blkid /dev/sda4</span></span>
<span class="line"><span>/dev/sda4: LABEL=&quot;vbird_xfs&quot; UUID=&quot;3eea6909-0633-4bc4-b125-e1db880db48d&quot; TYPE=&quot;xfs&quot; PARTLABEL=&quot;Linux filesystem&quot; PARTUUID=&quot;fdef7d45-c71a-42b8-bed1-f547633e3831&quot;</span></span>
<span class="line"><span>[root@study /]# vim /etc/fstab</span></span>
<span class="line"><span>#[装置/UUID 等]                          [挂载点]         [文件系统]     [文件系统参数] [dump] [fsck]</span></span>
<span class="line"><span>/dev/mapper/centos-root                   /                 xfs           defaults        0 0</span></span>
<span class="line"><span>UUID=d3dd9ff1-827d-4ac1-9fe6-f3ab1e7b0f5e /boot             xfs           defaults        0 0</span></span>
<span class="line"><span>/dev/mapper/centos-home                   /home             xfs           defaults        0 0</span></span>
<span class="line"><span>/dev/mapper/centos-swap                    swap             swap          defaults        0 0</span></span>
<span class="line"><span>UUID=3eea6909-0633-4bc4-b125-e1db880db48d /data/xfs         xfs           defaults        0 0</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@study /]# df /data/xfs/</span></span>
<span class="line"><span>文件系统         1K-块  已用    可用     已用% 挂载点</span></span>
<span class="line"><span>/dev/sda4      1038336 32864 1005472    4%   /data/xfs</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启后，/dev/sda4还在，/etc/fstab 是开机时的配置文件，不过，实际 filesystem 的挂载是记录到 /etc/mtab 与 /proc/mounts 这两个文件当中的。每次我们在更改 filesystem 的挂载时，也会同时更改这两个文件</p><h4 id="单人模式根目录权限只读" tabindex="-1"><a class="header-anchor" href="#单人模式根目录权限只读"><span>单人模式根目录权限只读</span></a></h4><p>在配置/etc/fstab时输入错误数据，导致无法顺利开机，进入单人模式，这时 根目录/是read only的状态，就无法修改/etc/fstab, 也无法更新/etc/mtab. 使用下面的命令使 /变为rw状态。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount -n -o remount,rw /</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="特殊装置-loop-挂载-映象档不刻录就挂载使用" tabindex="-1"><a class="header-anchor" href="#特殊装置-loop-挂载-映象档不刻录就挂载使用"><span>特殊装置 loop 挂载 (映象档不刻录就挂载使用)</span></a></h3><h4 id="loop设备介绍" tabindex="-1"><a class="header-anchor" href="#loop设备介绍"><span>Loop设备介绍</span></a></h4><h5 id="一、简单介绍" tabindex="-1"><a class="header-anchor" href="#一、简单介绍"><span>一、简单介绍</span></a></h5><p>Loop设备是一种块设备，但是它并不指向硬盘或者光驱，而是指向一个文件块或者另一种块设备。</p><p>一种应用的例子：将另外一种文件系统的镜像文件保存到一个文件中，例如iso文件，然后将一个Loop设备指向该文件，紧接着就可以通过mount挂载该loop设备到主文件系统的一个目录下了，我们就可以正常访问该镜像中的内容，就像访问一个文件系统一样。</p><h5 id="二、详细介绍" tabindex="-1"><a class="header-anchor" href="#二、详细介绍"><span>二、详细介绍</span></a></h5><p>loop设备是一种伪设备，是使用文件来模拟块设备的一种技术，文件模拟成块设备后, 就像一个磁盘或光盘一样使用。在使用之前，一个 loop 设备必须要和一个文件进行连接。这种结合方式给用户提供了一个替代块特殊文件的接口。因此，如果这个文件包含有一个完整的文件系统，那么这个文件就可以像一个磁盘设备一样被 mount 起来。之所以叫loop设备（回环），其实是从文件系统这一层来考虑的，<strong>因为这种被 mount 起来的镜像文件它本身也包含有文件系统，通过loop设备把它mount起来，它就像是文件系统之上再绕了一圈的文件系统，所以称为 loop。</strong></p><blockquote><p>回环设备（ &#39;loopback device&#39;）允许用户以一个普通磁盘文件虚拟一个块设备。设想一个磁盘设备，对它的所有读写操作都将被重定向到读写一个名为 disk-image 的普通文件而非操作实际磁盘或分区的轨道和扇区。（当然，disk-image 必须存在于一个实际的磁盘上，而这个磁盘必须比虚拟的磁盘容量更大。）回环设备允许你这样使用一个普通文件。</p></blockquote><p>回环设备以 /dev/loop0、/dev/loop1 等命名。每个设备可虚拟一个块设备。注意只有超级用户才有权限设置回环设备。</p><h5 id="三、简单使用" tabindex="-1"><a class="header-anchor" href="#三、简单使用"><span>三、简单使用</span></a></h5><p>一般在linux中会有8个loop设备，一般是/dev/loop0~loop7，可用通过<code>losetup -a</code>查看所有的loop设备，如果命令没有输出就说明所有的loop设备都没有被占用，你可以按照以下步骤创建自己的loop设备。</p><p>命令<code>losetup</code>可以对loop设备进行操作。</p><p>下面简单的说明loop设备映射或者指向一个文件的简单步骤：</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 创建一个文件</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1、dd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> if=/dev/zero</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> of=/var/loop.img</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bs=1M</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> count=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10240</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 使用losetup将文件转化为块设备</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2、losetup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/loop0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/loop.img</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 通过lsblk查看刚刚创建的块设备</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">lsblk</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">grep</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> loop0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">losetup</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> –a</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3、2步骤过后，我们就获得了一个磁盘，在这</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 首先创建一个目录：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /myloopdev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 接着挂载：</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mount</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /dev/loop0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /myloopdev</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 5、就可以进入myloopdev目录，对该虚拟磁盘进行操作了。就像使用真实磁盘一样，例如：echo “hello world!” &gt; hello_world.txt</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 6、使用结束，我们卸载该磁盘，umount /myloopdev</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 7、接着删除该loop设备，losetup –d  /dev/loop0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="四、使用loop设备完成一些功能" tabindex="-1"><a class="header-anchor" href="#四、使用loop设备完成一些功能"><span>四、使用loop设备完成一些功能</span></a></h5><p>上面三简单介绍了如何使用Loop指向一个文件，接下介绍使用loop的一些场景。<br> 利用Loop设备作为一个虚拟光驱或者虚拟软驱</p><p>1、回环设备关联文件。<br><code>losetup /dev/loop0 a.iso</code><br> losetup命令用来实现回环设备和文件的关联。这个命令还可以实现文件系统的加密，有兴趣的朋友可以查看手册。</p><p>2、挂载回环设备到特定目录，我们假设要挂载到/mnt/下面。<br><code>mount /dev/loop0 /mnt/</code><br> 这样/mnt/下面就是a.iso的内容了。可以通过shell去访问它了。</p><p>3、用完之后，需要卸载回环设备。<br><code>umount /mnt/</code><br> 这样设备就卸载，/mnt/下面就不是a.iso的文件了。</p><p>4、回环设备和关联文件分离。虽然已经在系统中卸载了回环设备，但是这个设备和文件的关联还存在。假如你还要用这个设备关联其他的文件，系统会提示这个设备正在忙。所以需要让回环设备和关联文件分离。<br><code>losetup -d /dev/loop0</code><br> 这样一个光盘镜像的使用就完成了。当然同理也可以通过回环设备挂载其他的虚拟文件，比如虚拟软盘img等。</p><h4 id="挂载光盘-dvd-映象文件" tabindex="-1"><a class="header-anchor" href="#挂载光盘-dvd-映象文件"><span>挂载光盘/DVD 映象文件</span></a></h4><p>下载了 Linux 或者是其他所需光盘/DVD 的映象文件后， 不需要刻录成光盘才能够使用该文件里面的数据，可以通过 loop 设备挂载</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-shell"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ll -h /tmp/CentOS-7.0-1406-x86_64-DVD.iso</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> root</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 3.9G</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 7</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /tmp/CentOS-7.0-1406-x86_64-DVD.iso</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 看到上面的结果吧！这个文件就是映象档，文件非常的大吧！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mkdir /data/centos_dvd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# mount -o loop /tmp/CentOS-7.0-1406-x86_64-DVD.iso /data/centos_dvd</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# df /data/centos_dvd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Filesystem</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 1K-blocks</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Used</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Available</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Use%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mounted</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> on</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/dev/loop0</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4050860</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4050860</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 100%</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /data/centos_dvd</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 就是这个项目！ .iso 映象文件内的所有数据可以在 /data/centos_dvd 看到！</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# ll /data/centos_dvd</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">total</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 607</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 502</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> CentOS_BuildTag</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> &lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">==瞧！就是</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> DVD</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 的内容啊！</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">drwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 502</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2048</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EFI</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 502</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 611</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> EULA</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-rw-r--r--.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 502</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 18009</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 5</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GPL</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">drwxr-xr-x.</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 500</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 502</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2048</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Jul</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 4</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 2014</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> images</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">.....</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">底下省略</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).....</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[root@study ~]# umount /data/centos_dvd/</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 测试完成！记得将数据给他卸除！同时这个映像档也被鸟哥删除了...测试机容量不够大！</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!----><!--[--><h2 id="doc-changelog" tabindex="-1"><a href="#doc-changelog" class="header-anchor"><span>更新日志</span></a></h2><div class="vp-changelog-wrapper"><div class="vp-changelog-header"><div class="vp-latest-updated"><span class="vp-changelog-icon"></span><span data-allow-mismatch>2025/11/19 08:16</span></div><div><span class="vp-changelog-menu-icon"></span><span>查看所有更新日志</span></div></div><ul class="vp-changelog-list"><!--[--><li class="vp-changelog-item-commit"><span class="vp-changelog-hash" target="_blank" rel="noreferrer"><code>9ffcb</code></span><span class="vp-changelog-divider">-</span><span class="vp-changelog-message">gengxin</span><span class="vp-changelog-date" data-allow-mismatch>于 <time datetime="2025-11-19T08:16:03.000Z">2025/11/19</time></span></li><!--]--></ul></div><!--]--><!----></div><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/Dhongli/vuepress-blog/edit/master/src/linux/Linux磁盘与文件系统管理.md" aria-label="编辑此页" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->编辑此页<!----></a></div><div class="vp-meta-item git-info"><!----><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: 1215765236@qq.com">daihongli</span><!--]--><!--]--></div></div></footer><!----><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">默认页脚</div><div class="vp-copyright">Copyright © 2025 Henry Dai </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.b96c3b68.js" defer></script><script src="/assets/js/1960.b4000e88.js" defer></script><script src="/assets/js/app.c88efbf5.js" defer></script>
  </body>
</html>
